(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{429:function(s,t,a){"use strict";a.r(t);var e=a(6),v=Object(e.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"备份管理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#备份管理"}},[s._v("#")]),s._v(" 备份管理")]),s._v(" "),a("blockquote",[a("p",[s._v("参考内容：https://www.cnblogs.com/beer/p/4842850.html")])]),s._v(" "),a("p",[s._v("[toc]")]),s._v(" "),a("h1",{attrs:{id:"一：-文件系统"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一：-文件系统"}},[s._v("#")]),s._v(" 一： 文件系统")]),s._v(" "),a("h2",{attrs:{id:"_1-0-硬盘的分类"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-0-硬盘的分类"}},[s._v("#")]),s._v(" 1.0 硬盘的分类")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("机械硬盘:具有机械结构，由磁头、马达、盘片等组成，")])]),s._v(" "),a("li",[a("p",[s._v("固态硬盘:不具有机械结构,主体其实就是一块PCB板，而这块PCB板上最基本的配件就是控制芯片，缓存芯片（部分低端硬盘无缓存芯片）和用于存储数据的闪存芯片。")])])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gss0.baidu.com/-4o3dSag_xI4khGko9WTAnF6hhy/zhidao/pic/item/8326cffc1e178a82fd41fd54f103738da877e8c1.jpg",alt:""}})]),s._v(" "),a("ul",[a("li",[s._v("混合硬盘: 混合硬盘就是在机械硬盘里面加入一块缓存芯片，特性和机械硬盘一样，因为加入了一块缓存芯片，速度比纯机械硬盘稍快。")])]),s._v(" "),a("h2",{attrs:{id:"_1-1-磁盘的结构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-磁盘的结构"}},[s._v("#")]),s._v(" 1.1 磁盘的结构")]),s._v(" "),a("h3",{attrs:{id:"_1-1-1-旧式磁盘"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-1-旧式磁盘"}},[s._v("#")]),s._v(" 1.1.1 旧式磁盘")]),s._v(" "),a("p",[s._v("这里讲的主要是网上所谓的老式磁盘，它是由一个个盘片组成的，我们先从个盘片结构讲起。如图所示，图中的一圈圈灰色同心圆为一条条磁道，从圆心向外画直线，可以将磁道划分为若干个弧段，每个磁道上一个弧段被称之为一个扇区（图践绿色部分）。扇区是磁盘的最小组成单元，通常是 512 字节。")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://pic002.cnblogs.com/images/2012/295881/2012052117213095.gif",alt:""}})]),s._v(" "),a("p",[a("strong",[s._v("老式磁盘一个盘片的结构")])]),s._v(" "),a("p",[s._v("下图展示了由一个个盘片组成的磁盘立体结构，一个盘片上下两面都是可读写的，图中蓝色部分叫柱面（cylinder）。")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://pic002.cnblogs.com/images/2012/295881/2012052117224297.gif",alt:""}})]),s._v(" "),a("p",[a("strong",[s._v("老式磁盘的整体结构")])]),s._v(" "),a("p",[s._v("简简单介绍了磁盘结构后，下面我们将对磁盘的参数进行讲解。磁盘的常见参数如下：")]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("磁头（head）")])]),s._v(" "),a("li",[a("strong",[s._v("磁道（track）")])]),s._v(" "),a("li",[a("strong",[s._v("柱面（cylinder）")])]),s._v(" "),a("li",[a("strong",[s._v("扇区（sector）")])]),s._v(" "),a("li",[a("strong",[s._v("圆盘（platter）")])])]),s._v(" "),a("p",[s._v("图中磁盘是一个 3 个圆盘 6 个磁头，7 个柱面（每个盘片 7 个磁道） 的磁盘，图 2 中每条磁道有 12 个扇区，所以此磁盘的容量为 6"),a("em",[s._v("7")]),s._v("12*512 字节。")]),s._v(" "),a("p",[s._v("即："),a("strong",[s._v("存储容量 ＝ 磁头数 × 磁道 (柱面) 数 × 每道扇区数 × 每扇区字节数")])]),s._v(" "),a("h3",{attrs:{id:"_1-1-2-现代磁盘"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-2-现代磁盘"}},[s._v("#")]),s._v(" 1.1.2 现代磁盘")]),s._v(" "),a("p",[s._v("下面讲一下现代磁盘，在老式磁盘中，尽管磁道周长不同，但每个磁道上的扇区数是相等的，越往圆心扇区弧段越短，但其存储密度越高。不过这种方式显然比较浪费空间，因此现代磁盘则改为等密度结构，这意味着外围磁道上的扇区数量要大于内圈的磁道，寻址方式也改为以扇区为单位的线性寻址。为了兼容老式的 3D 寻址方式，现代磁盘控制器中都有一个地址翻译器将 3D 寻址参数翻译为线性参数。")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://pic002.cnblogs.com/images/2012/295881/2012052117250525.gif",alt:""}})]),s._v(" "),a("p",[s._v("一张 Linux 的分区表**")]),s._v(" "),a("p",[s._v("此外，因为磁盘容量的提升，还有主流的文件系统将4k作为一个数据存储单元，以前将一个扇区划分512b显然不太合理，现在生产的硬盘一个扇区大多是4k(原来的8个扇区)。")]),s._v(" "),a("h2",{attrs:{id:"_1-2-分区表"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-分区表"}},[s._v("#")]),s._v(" 1.2. 分区表")]),s._v(" "),a("h3",{attrs:{id:"_1-2-1-主引导记录-mbr-传统的分区方案"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-1-主引导记录-mbr-传统的分区方案"}},[s._v("#")]),s._v(" 1.2.1 主引导记录(MBR)---传统的分区方案")]),s._v(" "),a("p",[s._v("传统的分区方案(称为MBR分区方案)是将分区信息保存到磁盘的第一个扇区(MBR扇区)中的64个字节中，每个分区项占用16个字节，这16个字节中存有活动状态标志、文件系统标识、起止柱面号、磁头号、扇区号、隐含扇区数目(4个字节)、分区总扇区数目(4个字节)等内容。")]),s._v(" "),a("p",[s._v("由于MBR扇区只有64个字节用于分区表，所以只能记录4个分区的信息。这就是硬盘主分区数目不能超过4个的原因。后来为了支持更多的分区，引入了扩展分区及逻辑分区的概念。但每个分区项仍用16个字节存储。")]),s._v(" "),a("h3",{attrs:{id:"_1-2-2-全局唯一标识分区-guid-主流的分区方案"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-2-全局唯一标识分区-guid-主流的分区方案"}},[s._v("#")]),s._v(" 1.2.2 全局唯一标识分区(GUID)---主流的分区方案")]),s._v(" "),a("p",[s._v("GUID分区表(简称GPT。使用GUID分区表的磁盘称为GPT磁盘)是源自EFI标准的一种较新的磁盘分区表结构的标准。与目前普遍使用的主引导记录(MBR)分区方案相比，GPT提供了更加灵活的磁盘分区机制。它具有如下优点：")]),s._v(" "),a("ul",[a("li",[s._v("支持2TB以上的大硬盘。")]),s._v(" "),a("li",[s._v("每个磁盘的分区个数几乎没有限制。")]),s._v(" "),a("li",[s._v("分区大小几乎没有限制。")])]),s._v(" "),a("h3",{attrs:{id:"_1-2-3-文件系统"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-3-文件系统"}},[s._v("#")]),s._v(" 1.2.3 文件系统")]),s._v(" "),a("blockquote",[a("p",[s._v("操作系统对系统的软件资源（不论是应用软件和系统软件）的管理都以文件方式进行，承担这部分功能的操作系统称为文件系统。")])]),s._v(" "),a("p",[s._v("什么是文件系统？")]),s._v(" "),a("blockquote",[a("h2",{attrs:{id:"文件系统是操作系统中-管理存储介值中数据资源的程序-和-被管理的文件和数据结构（如目录和索引表等）的集合。"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#文件系统是操作系统中-管理存储介值中数据资源的程序-和-被管理的文件和数据结构（如目录和索引表等）的集合。"}},[s._v("#")]),s._v(" 文件系统是"),a("strong",[s._v("操作系统")]),s._v("中 管理存储介值中数据资源的程序 和 被管理的文件和数据结构（如目录和索引表等）的集合。")])]),s._v(" "),a("p",[s._v("从系统角度来看，文件系统是对文件存储器的存储空间进行组织、分配和回收，负责文件的存储、检索、共享和保护。")]),s._v(" "),a("blockquote",[a("ul",[a("li",[s._v("从用户角度来看，文件系统主要是实现“按名存取”，文件系统的用户只要知道所需文件的文件名，就可存取文件中的信息，而无需知道这些文件究竟存放在什么地方。")])])]),s._v(" "),a("p",[s._v("简单来说，分区特定的文件系统提供给相应的操作系统读取、修改、调用、管理等操作的 存储介值和标准。")]),s._v(" "),a("p",[s._v("目前linux常用的文件系统是"),a("strong",[s._v("ext4")]),s._v("和"),a("strong",[s._v("xfs")]),s._v("，windows则是"),a("strong",[s._v("ntfs")])]),s._v(" "),a("ul",[a("li",[a("p",[s._v("ext4是第四代扩展文件系统（英语：Fourth EXtended filesystem，缩写为ext4）")]),s._v(" "),a("ul",[a("li",[s._v("是linux系统下的日志文件系统，是ext3文件系统的后继版本\ne   - xt4的文件系统容量达到1EB，而文件容量则达到16TB，这是一个非常大的数字了。对一般的台式机和服务器而言，这可能并不重要，但对于大型磁盘阵列的用户而言，这就非常重要了。")]),s._v(" "),a("li",[s._v("ext3目前只支持32000个子目录，而ext4取消了这一限制，理论上支持无限数量的子目录")])])]),s._v(" "),a("li",[a("p",[s._v("xfs是一种非常优秀的日志文件系统，它是SGI公司设计的。xfs被称为业界最先进的、最具可升级性的文件系统技术")]),s._v(" "),a("ul",[a("li",[s._v("xfs是一个64位文件系统，最大支持8EB减1字节的单个文件系统，实际部署时取决于宿主操作系统的最大块限制。对于一个32位Linux系统，文件和文件系统的大小会被限制在16TB")]),s._v(" "),a("li",[s._v("xfs在很多方面确实做的比ext4好，ext4受限制于磁盘结构和兼容问题，可扩展性和scalability确实不如xfs，另外xfs经过很多年发展，各种锁的细化做的也比较好")])])]),s._v(" "),a("li",[a("p",[s._v("NTFS是Windows NT操作系统使用的文件系统，它具有很强的安全特性和文件系统恢复功能，可以处理巨大的存储媒体，支持多种操作系统。")])])]),s._v(" "),a("h2",{attrs:{id:"_1-3-linux下存储设备的管理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-linux下存储设备的管理"}},[s._v("#")]),s._v(" 1.3 linux下存储设备的管理")]),s._v(" "),a("h3",{attrs:{id:"_1-3-1-位置和命名"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-1-位置和命名"}},[s._v("#")]),s._v(" 1.3.1 位置和命名")]),s._v(" "),a("p",[s._v("linux中一切皆文件，存储设备也是如此，linux设备文件位于/dev/目录下")]),s._v(" "),a("p",[s._v("目前存储设备接口基本使用的是SATA/SCSI或者外置用的usb接口，命名规则")]),s._v(" "),a("blockquote",[a("p",[s._v("sd[a-p]数字")]),s._v(" "),a("ul",[a("li",[s._v("其中a-p是磁盘的标识，数字是分区的标识")]),s._v(" "),a("li",[s._v("比如系统识别的第一块磁盘就是/dev/sda")]),s._v(" "),a("li",[s._v("该磁盘的第一个分区则是文件/dev/sda1\n以此类推")])])]),s._v(" "),a("blockquote",[a("p",[s._v("其他设备：比如光驱、打印机、鼠标键盘等命名类似，需要使用时可以查找相关资料")])]),s._v(" "),a("h3",{attrs:{id:"_1-3-2-linux下的分区"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-2-linux下的分区"}},[s._v("#")]),s._v(" 1.3.2 linux下的分区")]),s._v(" "),a("blockquote",[a("p",[s._v('和 Windows 完全不同，Linux 下面的所有目录都来自于 "/" 目录，没有将硬盘分区成 C、D、E 盘。Linux 下所有的文件系统都衍生于同一个根节点，所有的磁盘必须挂载在文件系统相应的目录下面。')])]),s._v(" "),a("ul",[a("li",[s._v('作用：让分区在操作系统中获得一个可供唯一识别的标识\nlinux: 使用挂载的方式，将某一个分区“挂”在linux下的目录下，此后只要向这个目录存储文件，存储的实际物理位置就是在相应的磁盘上，类似windows给分区盘符的过程，下面会提到，windows和linux的目录结构不一样，windows和linux"'),a("strong",[s._v("挂载")]),s._v('"的方式也不一样')])]),s._v(" "),a("h3",{attrs:{id:"_1-3-2-磁盘管理工具-fdisk"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-2-磁盘管理工具-fdisk"}},[s._v("#")]),s._v(" 1.3.2 磁盘管理工具---fdisk")]),s._v(" "),a("p",[s._v("不管是 Windows 还是 Linux，都有如下流程：")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("新购置的物理硬盘，必须要分区，不管是分一个区还是多个区。这个分区实际上是对磁盘的分区表进行数据定入，和启动位置有关")])]),s._v(" "),a("li",[a("dl",{staticClass:"first docutils"},[a("dt",[s._v("分区的硬盘必须要格式化相应的文件系统")]),s._v(" "),a("dd",[a("ul",[a("li",[s._v("Windows 系统一般是 NTFS 文件系统")]),s._v(" "),a("li",[s._v("Linux 系统一般是 EXT4 文件系统")])])])])]),s._v(" "),a("li",[a("dl",{staticClass:"first docutils"},[a("dt",[s._v("被格式化的磁盘必须要挂载到操作系统相应的文件目录下")]),s._v(" "),a("dd",[a("ul",[a("li",[s._v("Windows 相当于在 C/D/E 盘之上还有一个根目录，但是显然它实际上没有按照这种观念来普及此系统。Windows 系统自动帮用户完成了挂载分区到目录的工作，即自动将磁盘分区挂载到 C/D/E 盘的 “目录”")]),s._v(" "),a("li",[s._v("Linux 则除了会自动挂载根分区启动项外，别的需要用户自己配置。")])])])])])]),s._v(" "),a("p",[s._v("windows下磁盘的管理可以通过系统自带的磁盘管理器或disk genius类似的软件来管理;\nlinux下则有一款老牌的软件fdisk被系统预装，当然还有图形化工具gparted也很不错。")]),s._v(" "),a("ul",[a("li",[a("p",[a("code",[s._v("fdisk -l")]),s._v(":列出当前硬盘信息")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("fdisk 设备名")]),s._v("：列出该设备的信息，并进入交互，根据提示操作")])]),s._v(" "),a("li",[a("p",[s._v("命令")]),s._v(" "),a("ul",[a("li",[s._v("挂载")])])])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("mount 设备名  挂载目录\nmount /dev/sda8 /home/aa\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v("- 卸载\n")])])]),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("umount 设备名\numount /dev/sda8\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("blockquote",[a("p",[s._v("小动手1：")])]),s._v(" "),a("blockquote",[a("ul",[a("li",[s._v("试着给虚拟机新建一块磁盘（直接装实体机的也可以）")])])]),s._v(" "),a("blockquote",[a("ul",[a("li",[s._v("使用fdisk新建分区表，新建分区（设置分区的文件系统ext4）")])])]),s._v(" "),a("blockquote",[a("ul",[a("li",[s._v("在自己的home目录下新建HELLO文件夹,把刚才新建的分区挂载在HELLO文件夹")])])]),s._v(" "),a("blockquote",[a("ul",[a("li",[s._v("进入HELLO文件夹，新建一个文件")])])]),s._v(" "),a("blockquote",[a("ul",[a("li",[s._v("卸载刚才挂上的分区")])])]),s._v(" "),a("blockquote",[a("ul",[a("li",[s._v("在自己的home目录下新建WORLD文件夹,把刚才分区挂载在WORLD文件夹")])])]),s._v(" "),a("blockquote",[a("ul",[a("li",[s._v("ls 查看一下WORLD目录下有哪些内容")])])]),s._v(" "),a("h1",{attrs:{id:"二：文件目录"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二：文件目录"}},[s._v("#")]),s._v(" 二：文件目录")]),s._v(" "),a("p",[s._v("看一下linux下的目录结构和相应功能")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("目录")]),s._v(" "),a("th",[s._v("内容")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("/bin")]),s._v(" "),a("td",[s._v("存放系统命令的目录,普通用户和超级用户都可以执行,放在/bin下的命令在单用户模式下也可以执行")])]),s._v(" "),a("tr",[a("td",[s._v("/sbin/")]),s._v(" "),a("td",[s._v("保存和系统环境设置相关的命令,只有超级用户可以使用这些命令进行系统环境设置,但是有些命令可以允许普通用户查看")])]),s._v(" "),a("tr",[a("td",[s._v("/usr/bin/")]),s._v(" "),a("td",[s._v("存放系统命令的目录,普通用户和超级用户都可以执行。这些命令和系统启动无关,在单用户模式下不能执行")])]),s._v(" "),a("tr",[a("td",[s._v("/usr/sbin")]),s._v(" "),a("td",[s._v("存放根文件系统不必要的系统管理命令,例如多数服务程序。只有超级用户可以使用。大家其实可以注意到Linux的系统,在所有“sbin”目录中保存的命令只有超级用户可以使用,“bin”目录中保存的命令所有用户都可以使用")])]),s._v(" "),a("tr",[a("td",[s._v("/boot/")]),s._v(" "),a("td",[s._v("系统启动目录,保存系统启动相关的文件,如内核文件和启动引导程序(grub)文件等")])]),s._v(" "),a("tr",[a("td",[s._v("/dev/")]),s._v(" "),a("td",[s._v("设备文件保存位置。我们已经说过Linux中所有内容以文件形式保存,包括硬件。那么这个目录就是用来保存所有硬件设备文件的")])]),s._v(" "),a("tr",[a("td",[s._v("/etc/")]),s._v(" "),a("td",[s._v("配置文件保存位置。系统内所有采用默认安装方式(rpm安装)的服务的配置文件全部都保存在这个目录当中,如用户账户和密码,服务的启动脚本,常用服务的配置文件等")])]),s._v(" "),a("tr",[a("td",[s._v("/home/")]),s._v(" "),a("td",[s._v("普通用户的家目录。建立每个用户时,每个用户要有一个默认登录位置,这个位置就是这个用户的家目录,所有普通用户的家目录就是在/home下建立一个和用户名相同的目录。如用户user1的家目录就是/home/user1")])]),s._v(" "),a("tr",[a("td",[s._v("lib")]),s._v(" "),a("td",[s._v("系统调用的函数库保存位置,该目录含有系统引导过程，及运行系统命令所需要挟内核模块和各种动态链接共享库文件")])]),s._v(" "),a("tr",[a("td",[s._v("/lost+found/")]),s._v(" "),a("td",[s._v("当系统意外崩溃或机器意外关机,而产生一些文件碎片放在这里。当系统启动的过程中fsck工具会检查这里,并修复已经损坏的文件系统。这个目录只在每个分区中出现,例如/lost+found就是根分区的备份恢复目录,/boot/lost+found就是/boot分区的备份恢复目录")])]),s._v(" "),a("tr",[a("td",[s._v("/media/")]),s._v(" "),a("td",[s._v("挂载目录。系统建议是用来挂载媒体设备的,例如软盘和光盘")])]),s._v(" "),a("tr",[a("td",[s._v("/mnt/")]),s._v(" "),a("td",[s._v("挂载目录,早期Linux中只有这一个挂载目录,并没有细分。现在这个目录系统建议挂载额外设备,如U盘,移动硬盘和其他操作系统的分区")])]),s._v(" "),a("tr",[a("td",[s._v("/opt/")]),s._v(" "),a("td",[s._v("第三方安装的软件保存位置。这个目录就是放置和安装其他软件的位置,手工安装的源码包软件都可以安装到这个目录当中。不过也有人习惯放置到/usr/local/目录当中")])]),s._v(" "),a("tr",[a("td",[s._v("/proc/")]),s._v(" "),a("td",[s._v("虚拟文件系统,该目录中的数据并不保存到硬盘当中,而是保存到内存当中。主要保存系统的内核,进程,外部设备状态和网络状态灯。如/proc/cpuinfo是保存CPU信息的,/proc/devices是保存设备驱动的列表的/proc/filesystems是保存文件系统列表的,/proc/net/是保存网络协议信息的")])]),s._v(" "),a("tr",[a("td",[s._v("/sys/")]),s._v(" "),a("td",[s._v("虚拟文件系统。和/proc目录相似,都是保存在内存当中的,主要是保存于内核相关信息的")])]),s._v(" "),a("tr",[a("td",[s._v("/root/")]),s._v(" "),a("td",[s._v("超级用户的家目录。普通用户家目录在“/home”下,超级用于家目录直接在“/”下")])]),s._v(" "),a("tr",[a("td",[s._v("/tmp/")]),s._v(" "),a("td",[s._v("临时目录。系统存放临时文件的目录,该目录下所有用户都可以访问和写入。建议此目录中不能保存重要数据,每次开机都把该目录清空")])]),s._v(" "),a("tr",[a("td",[s._v("/usr/")]),s._v(" "),a("td",[s._v("系统 软 件 资 源 目 录 。 注 意 usr 不 是 user 的 缩 写 , 而 是 “ Unix Softwre Resource”的缩写,所以不是存放用户数据,而是存放系统软件资源的目录。系统中安装的软件大多数保存在这里,所以除了/usr/bin/和/usr/sbin/这两个目录,我在介绍几个/usr/下的二级目录")])]),s._v(" "),a("tr",[a("td",[s._v("/var/")]),s._v(" "),a("td",[s._v("动态数据保存位置。主要保存缓存、日志以及软件运行所产生的文件")])])])]),s._v(" "),a("blockquote",[a("p",[s._v("关于根目录下的其它目录及其子目录的详细介绍及目录之间的区别，请参考 linux 官网关于 FHS 的最新更新（基本上每年都会有更新）。")])]),s._v(" "),a("h1",{attrs:{id:"三：文件权限"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#三：文件权限"}},[s._v("#")]),s._v(" 三：文件权限")]),s._v(" "),a("p",[s._v("在 Linux 下面对文件的操作有个很重要的概念，就是：文件权限。很多初学者认为 Linux 不好用，基本上很大的原因就是止步于这个地方就没有深入研究下去。因为对于任何一个系统来讲，文件数据的各种操作肯定是很高频的交互，在 Linux 系统下，如果不了解文件系统的权限概念，那么在对文件数据进行操作的时候，必然会遇到各种阻碍，然后不得已而放弃了 Linux 的继续研究。")]),s._v(" "),a("h2",{attrs:{id:"_3-1-文件属性字段"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-文件属性字段"}},[s._v("#")]),s._v(" 3.1 文件属性字段")]),s._v(" "),a("p",[s._v("在图形界面下，文件的权限是通过在文件图标是否上锁（或者 X 号等）来进行形象可视化，在 CLI 界面，则是通过特殊的文本标记来显示：")]),s._v(" "),a("pre",[s._v("➜  /  ll |grep bin\ndrwxr-xr-x   2 root root 4.0K  9月 25 14:56 bin\ndrwxr-xr-x   2 root root  12K  9月 25 14:55 sbin")]),s._v(" "),a("p",[s._v("如上对目录及文件的描述一共 7 段：")]),s._v(" "),a("ol",[a("li",[s._v("permissions：文件的详细信息，主要是权限信息 / 类型信息")]),s._v(" "),a("li",[s._v("link：文件硬链接数或目录子目录数")]),s._v(" "),a("li",[s._v("user：文件所属用户")]),s._v(" "),a("li",[s._v("group：文件所属组")]),s._v(" "),a("li",[s._v("size：文件大小")]),s._v(" "),a("li",[s._v("time：文件创建时间")]),s._v(" "),a("li",[s._v("file：文件名称")])]),s._v(" "),a("h2",{attrs:{id:"_3-2-文件类型"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-文件类型"}},[s._v("#")]),s._v(" 3.2 文件类型")]),s._v(" "),a("p",[s._v("典型的文字文件权限描述字符如下所示：")]),s._v(" "),a("pre",[s._v("drwxr-xr-x")]),s._v(" "),a("p",[s._v("一共 10 位，按照功能对位进行划分，总共可以分为 4 个功能段，如下表所示：")]),s._v(" "),a("caption",[s._v("文件权限及类型信息")]),a("colgroup",[a("col",{attrs:{width:"25%"}}),a("col",{attrs:{width:"25%"}}),a("col",{attrs:{width:"25%"}}),a("col",{attrs:{width:"25%"}})]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("类型")]),s._v(" "),a("th",[s._v("用户权限")]),s._v(" "),a("th",[s._v("组权限")]),s._v(" "),a("th",[s._v("其它权限")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("1")]),s._v(" "),a("td",{attrs:{colspan:"3"}},[s._v("3")])]),s._v(" "),a("tr",[a("td",[s._v("d")]),s._v(" "),a("td",[s._v("rwx")]),s._v(" "),a("td",{attrs:{colspan:"2"}},[s._v("r-x")])])])]),s._v(" "),a("p",[s._v("第一段表示文件的类型：")]),s._v(" "),a("ul",[a("li",[a("p",[a("strong",[s._v("d")]),s._v("： directory，表示目录")])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("-")]),s._v("： 短横线 “空” 表示普通文件，例如：文本文件，二进制文件")])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("l")]),s._v("： link，表示链接文件，例如：快捷方式")])]),s._v(" "),a("li",[a("p",[s._v("b： block，表示块状设备，例如：磁盘")])]),s._v(" "),a("li",[a("p",[s._v("c： character, 表示字符特殊文件，例如：控制台终端 / 打印机等等")])]),s._v(" "),a("li",[a("p",[s._v("p： pipe, 管理文件")])])]),s._v(" "),a("blockquote",[a("p",[s._v("一般对于应用层开发人员，最多接触的就是目录和普通文件两种，其它有兴趣的可以去具体的查阅相应的资料。")])]),s._v(" "),a("ul",[a("li",[s._v("其它类型")])]),s._v(" "),a("p",[s._v("第二段（2-4位）确定属主（该文件的所有者）拥有该文件的权限。")]),s._v(" "),a("p",[s._v("第三段（5-7位）确定属组（所有者的同组用户）拥有该文件的权限，")]),s._v(" "),a("p",[s._v("第四段（8-10位）确定其他用户拥有该文件的权限。")]),s._v(" "),a("blockquote",[a("p",[s._v("注意：每三位依序确定一组权限 rwx（读、写、执行），有相应权限就会标出字母，如果没有相应权限就会显示  -  。")])]),s._v(" "),a("p",[s._v("比如上述文件所属组就没有写（修改）的权限")]),s._v(" "),a("h2",{attrs:{id:"_3-3-文件权限介绍"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-文件权限介绍"}},[s._v("#")]),s._v(" 3.3 文件权限介绍")]),s._v(" "),a("p",[s._v("纯粹的文件操作权限的描述有三类：")]),s._v(" "),a("ul",[a("li",[s._v("r 可读")]),s._v(" "),a("li",[s._v("w 可写")]),s._v(" "),a("li",[s._v("x 可执行")])]),s._v(" "),a("p",[s._v("对文件操作的使用者身份划分成三类：")]),s._v(" "),a("ul",[a("li",[s._v("U User 直接从属用户")]),s._v(" "),a("li",[s._v("G Group 文件所属组")]),s._v(" "),a("li",[s._v("O Other 不属于上面两样的其它用户")])]),s._v(" "),a("p",[s._v("文件权限的三段，对应着不同的使用者身份对此文件的不同权限，任何身份的用户不能够对文件做超过其权限的事情。")]),s._v(" "),a("p",[s._v("特别注意，在 Linux 系统下：")]),s._v(" "),a("ul",[a("li",[s._v("不是通过扩展名来判定程序的类型的")]),s._v(" "),a("li",[s._v("不是通过 "),a("em",[s._v(".exe")]),s._v(" 来判定程序是否可执行，而是通过 "),a("em",[s._v("x")]),s._v(" 属性表明此文件可以被执行")]),s._v(" "),a("li",[s._v("和文件不同，目录的 "),a("em",[s._v("x")]),s._v(" 属性表示可以将工作路径切换到目录里面")])]),s._v(" "),a("h2",{attrs:{id:"_3-4-文件权限修改"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-4-文件权限修改"}},[s._v("#")]),s._v(" 3.4 文件权限修改")]),s._v(" "),a("h3",{attrs:{id:"_3-4-1-简化的数字标识"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-4-1-简化的数字标识"}},[s._v("#")]),s._v(" 3.4.1 简化的数字标识")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("touch hello.c\nchmod 755 hello.c\nll hello.c\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("看一下权限是不是变成-rwxr-xr-x呢")]),s._v(" "),a("p",[s._v("听过了刚才的内容知道这个是什么意思吗:")]),s._v(" "),a("ul",[a("li",[s._v("首先这是一个普通文件")]),s._v(" "),a("li",[s._v("所属者拥有读、写、执行所有权限（7）")]),s._v(" "),a("li",[s._v("所数组和其他只有读和执行的权限（5）")])]),s._v(" "),a("p",[s._v("为什么用7来表示所有权限，5表示读和写权限呢？？")]),s._v(" "),a("p",[s._v("先复习一下刚刚上面提到的数据：文件的权限字符为：『-rwxr-xr-x』， 这九个权限是三个三个一组的！其中，我们可以使用二进制对应的数字来代表各个权限，各权限的分数对照表如下：")]),s._v(" "),a("ul",[a("li",[s._v("r:4")]),s._v(" "),a("li",[s._v("w:2")]),s._v(" "),a("li",[s._v("x:1")])]),s._v(" "),a("p",[s._v("这样上面的755就可以理解了。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("rwx r-x r-x\n111 101 101\n7    5   5\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h3",{attrs:{id:"_3-4-2-通过数字修改"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-4-2-通过数字修改"}},[s._v("#")]),s._v(" 3.4.2 通过数字修改")]),s._v(" "),a("p",[s._v("chmod 数字 文件名\nchmod 755 hello.c")]),s._v(" "),a("h3",{attrs:{id:"_3-4-3-通过字母修改"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-4-3-通过字母修改"}},[s._v("#")]),s._v(" 3.4.3 通过字母修改")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("#  touch test1    // 创建 test1 文件\n\n# ls -l test1    // 查看 test1 默认权限\n\n# chmod u=rwx,g=rx,o=r  test1    // 修改 test1 权限\n\n# ls -al test1\n\n# chmod u=rwx,g=rx,o=r  test1    // 修改 test1 权限\n\n# chmod a-w  test1    // 去掉所有修改权限\n\n# chmod a+x  test1      // 增加所有执行权限\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("blockquote",[a("p",[s._v("思考：为什么我们新建文件后默认权限会是-rw-r--r--或是其他默认值呢？")])]),s._v(" "),a("h1",{attrs:{id:"四：重要的意识-备份"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#四：重要的意识-备份"}},[s._v("#")]),s._v(" 四：重要的意识---备份")]),s._v(" "),a("h2",{attrs:{id:"提要"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#提要"}},[s._v("#")]),s._v(" 提要")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("Linux 系统所有的数据都以文件的形式存在，所以备份就是直接拷贝文件；")])]),s._v(" "),a("li",[a("p",[s._v("硬盘分区也被当成文件，所以可以直接克隆硬盘数据。")])]),s._v(" "),a("li",[a("p",[s._v("非常建议系统备份的时候按照分区进行分别备份，并且也不建议安装系统的时候只给系统分一个分区。")])]),s._v(" "),a("li",[a("p",[s._v("有四个分区的好处是，一般系统坏了都是/分区的问题，/home没什么关系，所以这种情况，我可以只还原/分区，其他分区完全可以不用动，系统就可以恢复，会节省很多时间。")])]),s._v(" "),a("li",[a("p",[s._v("另外，为了保险起见，也可以对/home和/boot备份，但是备份频率完全没必要和/分区一样高。比如/分区每周备份一次，那/home和/boot完全可以一个月备份一次，因为这两个分区出问题的概率真的很小，而且变动也不会太频繁。")])]),s._v(" "),a("li",[a("p",[s._v("请注意，如果没有把/home或者/boot目录单独分一个区，一定不要加–exclude=/home或–exclude=/boot参数！！！")])])]),s._v(" "),a("h2",{attrs:{id:"备份的排除目录"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#备份的排除目录"}},[s._v("#")]),s._v(" 备份的排除目录")]),s._v(" "),a("blockquote",[a("p",[s._v("使用不带参数的mount命令查看文件系统，发现有四大虚拟的挂载点，它们分别是/sys、/proc、/dev、/run。这四个虚拟的挂载点是和硬盘没有关联的，所以在备份的时候需要排除掉，再加上我们挂载 U 盘的/media")])]),s._v(" "),a("ul",[a("li",[s._v("/proc：一个虚拟文件系统，系统运行的每一个进程都会自动在这个目录下面创建一个进程目录。既然是系统自动创建，也就没必要备份的必要了。")]),s._v(" "),a("li",[s._v("/tmp：一个临时文件夹，系统的一些临时文件会放在这里。")]),s._v(" "),a("li",[s._v("/lost+found：系统发生错误时（比如非法关机），可以在这里找回一些丢失文件。")]),s._v(" "),a("li",[s._v("/media：多媒体挂载点，像u盘、移动硬盘、windons分区等都会自动挂载到这个目录下。")]),s._v(" "),a("li",[s._v("/mnt：临时挂载点，你可以自己挂载一些文件系统到这里。")]),s._v(" "),a("li",[s._v("/run：系统从启动以来产生的一些信息文件。")]),s._v(" "),a("li",[s._v("/home：用户家目录，存放用户个人文件和应用程序。")]),s._v(" "),a("li",[s._v("/boot：和系统启动相关的文件，像grub相关文件都放在这里，这个目录很重要！")])]),s._v(" "),a("h2",{attrs:{id:"方案一：打包压缩（tar）"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#方案一：打包压缩（tar）"}},[s._v("#")]),s._v(" 方案一：打包压缩（tar）")]),s._v(" "),a("blockquote",[a("p",[s._v("和Windows不同，Linux不会限制root访问任何东西，你可以把分区上的所有东西都扔到一个TAR文件里去！")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('$ sudo su\n# unmount /dev/sdc1\n# mount /dev/sdc1 /mnt\n# tar cvpfz /mnt/cvpzf backup.tgz --exclude=/proc --exclude=/lost+found --exclude=/backup.tgz --exclude=/mnt –exclude=/sys /\n//或者可以集合在一起来写\n# tar cvpfz /mnt/fedora20180725.tgz --exclude={"/proc/*","/run/*","/mnt/*","/media/*","/sys/*","/lost+found","/dev/*","/tmp/*"}  /\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("解析：")]),s._v(" "),a("ul",[a("li",[s._v("tar：压缩程序")]),s._v(" "),a("li",[s._v("cvpfz：tar的选项，意思是“创建档案文件”、“保持权限”(保留所有东西原来的权限)、“使用gzip来减小文件尺寸”。")])]),s._v(" "),a("h2",{attrs:{id:"方案二：dd-压缩"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#方案二：dd-压缩"}},[s._v("#")]),s._v(" 方案二：dd+压缩")]),s._v(" "),a("p",[s._v("dd的选项与参数：")]),s._v(" "),a("ul",[a("li",[s._v("if   ：就是 input file 也可以是装置")]),s._v(" "),a("li",[s._v("of   ：就是 output file 也可以是装置")]),s._v(" "),a("li",[s._v("bs   ：规划的一个 block 的大小，若未指定则默认是 512 bytes(一个 sector 的大小)")]),s._v(" "),a("li",[s._v("count：多少个 bs 的意思。")])]),s._v(" "),a("hr"),s._v(" "),a("p",[s._v("EG1:\n使用 dd 命令直接克隆硬盘分区：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("sudo dd if=/dev/sda1 of=/dev/sdb1\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("还原：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("sudo dd if=/dev/sdb1 of=/dev/sda1\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("hr"),s._v(" "),a("p",[s._v("EG2:\n备份同时压缩和解压缩")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("dd if=/dev/sda1 | bzip2 > sda1.img.bz2\nbzip2 -dc sda1.img.bz2 | dd of=/dev/sda1\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("hr"),s._v(" "),a("p",[s._v("EG3:\ndd的小妙用：制作文件夹的镜像")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("dd if=/dev/zero of=new_img.img bs=1M count=20 //生成20M的文件\n\nmkfs.ext3 new_img.img\n\nmount new_img.img /mnt/new\n\ncp originfile /mnt/new -R\n\numount /mnt/new/  /      new_img.img文件里面就包括了originfile\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("h2",{attrs:{id:"how"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#how"}},[s._v("#")]),s._v(" How")]),s._v(" "),a("h1",{attrs:{id:"备份与恢复"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#备份与恢复"}},[s._v("#")]),s._v(" 备份与恢复")]),s._v(" "),a("blockquote",[a("p",[s._v("https://www.cnblogs.com/reddusty/p/4746093.html")])]),s._v(" "),a("h2",{attrs:{id:"提要-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#提要-2"}},[s._v("#")]),s._v(" 提要")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("Linux 系统所有的数据都以文件的形式存在，所以备份就是直接拷贝文件；硬盘分区也被当成文件，所以可以直接克隆硬盘数据。")])]),s._v(" "),a("li",[a("p",[s._v("Linux 系统在运行时其硬盘上的文件可以直接被覆盖，所以还原系统的时候不需要另外的引导盘。")])]),s._v(" "),a("li",[a("p",[s._v("当然，系统完全挂掉到无法启动这种情况还是需要另外的引导盘的。")])]),s._v(" "),a("li"),s._v(" "),a("li",[a("p",[s._v("非常建议系统备份的时候按照分区进行分别备份，并且也不建议安装系统的时候只给系统分一个分区。有四个分区的好处是，一般系统坏了都是/分区的问题，/home没什么关系，所以这种情况，我可以只还原/分区，其他分区完全可以不用动，系统就可以恢复，会节省很多时间。")])]),s._v(" "),a("li",[a("p",[s._v("另外，为了保险起见，也可以对/home和/boot备份，但是备份频率完全没必要和/分区一样高。比如/分区每周备份一次，那/home和/boot完全可以一个月备份一次，因为这两个分区出问题的概率真的很小，而且变动也不会太频繁。")])]),s._v(" "),a("li",[a("p",[s._v("请注意，如果没有把/home或者/boot目录单独分一个区，一定不要加–exclude=/home或–exclude=/boot参数！！！")])])]),s._v(" "),a("blockquote",[a("p",[s._v("使用不带参数的mount命令查看文件系统，发现有四大虚拟的挂载点，它们分别是/sys、/proc、/dev、/run。这四个虚拟的挂载点是和硬盘没有关联的，所以在备份的时候需要排除掉，再加上我们挂载 U 盘的/media")])]),s._v(" "),a("ul",[a("li",[s._v("/proc：一个虚拟文件系统，系统运行的每一个进程都会自动在这个目录下面创建一个进程目录。既然是系统自动创建，也就没必要备份的必要了。")]),s._v(" "),a("li",[s._v("/tmp：一个临时文件夹，系统的一些临时文件会放在这里。")]),s._v(" "),a("li",[s._v("/lost+found：系统发生错误时（比如非法关机），可以在这里找回一些丢失文件。")]),s._v(" "),a("li",[s._v("/media：多媒体挂载点，像u盘、移动硬盘、windons分区等都会自动挂载到这个目录下。")]),s._v(" "),a("li",[s._v("/mnt：临时挂载点，你可以自己挂载一些文件系统到这里。")]),s._v(" "),a("li",[s._v("/run：系统从启动以来产生的一些信息文件。")]),s._v(" "),a("li",[s._v("/home：用户家目录，存放用户个人文件和应用程序。")]),s._v(" "),a("li",[s._v("/boot：和系统启动相关的文件，像grub相关文件都放在这里，这个目录很重要！")])]),s._v(" "),a("h2",{attrs:{id:"一些磁盘命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一些磁盘命令"}},[s._v("#")]),s._v(" 一些磁盘命令")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("mount\nunmount\nfdisk\nmkfs.ext3 /dev/sdc1\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h2",{attrs:{id:"方案一：dd"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#方案一：dd"}},[s._v("#")]),s._v(" 方案一：dd")]),s._v(" "),a("p",[s._v("选项与参数：")]),s._v(" "),a("ul",[a("li",[s._v("if   ：就是 input file 也可以是装置")]),s._v(" "),a("li",[s._v("of   ：就是 output file 也可以是装置")]),s._v(" "),a("li",[s._v("bs   ：规划的一个 block 的大小，若未指定则默认是 512 bytes(一个 sector 的大小)")]),s._v(" "),a("li",[s._v("count：多少个 bs 的意思。")])]),s._v(" "),a("h3",{attrs:{id:"eg1"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#eg1"}},[s._v("#")]),s._v(" EG1:")]),s._v(" "),a("p",[s._v("使用 dd 命令直接克隆硬盘分区：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("sudo dd if=/dev/sda1 of=/dev/sdb1\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("还原：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("sudo dd if=/dev/sdb1 of=/dev/sda1\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"eg2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#eg2"}},[s._v("#")]),s._v(" EG2:")]),s._v(" "),a("p",[s._v("备份同时压缩和解压缩")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("dd if=/dev/sda1 | bzip2 > sda1.img.bz2\nbzip2 -dc sda1.img.bz2 | dd of=/dev/sda1\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h3",{attrs:{id:"eg3"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#eg3"}},[s._v("#")]),s._v(" EG3:")]),s._v(" "),a("p",[s._v("制作文件夹的镜像")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("dd if=/dev/zero of=new_img.img bs=1M count=200 //生成20M的文件\n\nmkfs.ext3 new_img.img\n\nmount new_img.img /mnt/new\n\ncp originfile /mnt/new -R\n\numount /mnt/new// new_img.img文件里面就包括了originfile\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("h2",{attrs:{id:"方案二：rsync"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#方案二：rsync"}},[s._v("#")]),s._v(" 方案二：rsync")]),s._v(" "),a("blockquote",[a("p",[s._v("referred from:https://opensource.com/article/17/1/rsync-backup-linux")])]),s._v(" "),a("p",[s._v("**rsync -PpavAHX 备份源目录 备份到位置 **")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('rsync -tpogaAXv / /mnt/backup/ --force --backup --backup-dir=date+%Y-%m-%d --delete --ignore-existing --ignore-errors --progress --exclude Cache --exclude cache --exclude={"/dev/*","/proc/*","/sys/*","/tmp/*","/run/*","/mnt/*","/media/*","/lost+found/*"}\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("`")]),s._v(" "),a("p",[s._v("关键的参数是：")]),s._v(" "),a("ul",[a("li",[s._v("--backup: 在覆盖前备份文件")]),s._v(" "),a("li",[s._v("--backup-dir="),a("code",[s._v("date +%Y-%m-%d")]),s._v(": 为备份的文件建立一个备份目录，看上去就像: 2002-08-15")]),s._v(" "),a("li",[s._v("-av: 存档(archive)模式和详细输出(verbose)模式。")])]),s._v(" "),a("p",[s._v("选择 rsync，是因为它具有如下优点：")]),s._v(" "),a("ul",[a("li",[s._v("在备份还原过程中，可以保存文件原有的时间、权限、软硬链接等信息；")]),s._v(" "),a("li",[s._v("首次备份时，需要复制所有文件，但是再次备份或还原系统时，只需要复制修改过的文件。")]),s._v(" "),a("li",[s._v("关于 rsync 的使用方法，其主要参考文档是"),a("strong",[s._v("man rsync")]),s._v("，另外，rsync 也可以作为守护进程运行用来建立文件备份服务器，可以参考文档"),a("strong",[s._v("man rsyncd.conf")]),s._v("。")])]),s._v(" "),a("h3",{attrs:{id:"备份"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#备份"}},[s._v("#")]),s._v(" 备份")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('$ sudo su\n# time rsync -PpavAHX / /mnt --bwlimit=1024\n-exclude={"/proc/*","/run/*","/mnt/*","/media/*","/sys/*","/lost+found","/dev/*","/tmp/*"}\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("ul",[a("li",[s._v("time 参数可以统计使用的时间")])]),s._v(" "),a("h3",{attrs:{id:"还原"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#还原"}},[s._v("#")]),s._v(" 还原")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('$ sudo su\n# rsync -PpavAHX /mnt /  --exclude={"/proc/*","/run/*","/mnt/*","/media/*","/sys/*","/lost+found","/dev/*","/tmp/*"}\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h3",{attrs:{id:"注意事项"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#注意事项"}},[s._v("#")]),s._v(" 注意事项")]),s._v(" "),a("ol",[a("li",[s._v("发现/home权限编程了700了\n修改下权限就好了")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("chmod 755 /home\nchmod 755 /srv /share1 /selinux /mnt /media /logs/\nchmod 755 /opt /sbin\nchmod 777 /tmp/\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("ol",{attrs:{start:"2"}},[a("li",[s._v("恢复系统，可不仅仅是运行 sudo time rsync -Pa /media/youxia/usb/backup_20160816/ /这么简单，还是有一些注意事项的。")])]),s._v(" "),a("ul",[a("li",[s._v("要记得恢复 Grub 的启动菜单。Ubuntu 系统在安装玩后，Grub 的启动菜单会自动隐藏，这给需要选择多系统的用户带来了困难，对于需要启动进入 rescue 模式的朋友来说就更加是一个障碍了。所以我们要恢复 Grub 的启动菜单。删除 /etc/default/grub 文件中的如下两行：")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("GRUB_HIDDEN*\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("然后调用 "),a("code",[s._v("sudo update-grub")]),s._v(" 命令更新 Grub 的配置")]),s._v(" "),a("p",[s._v("如果没有办法进入 rescue 模式，那就只有从 安装盘启动了。")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("尽量不要在不同质的电脑之间备份和恢复系统。比如说，我曾经把这台 Dell XPS 15 上的系统搞崩溃了，然后我拿另一台 Acer 的备份文件来恢复系统，本以为可以像 Ghost 安装 WinXP 一样方便，哪知恢复完成后连 Grub 都进不去，更别提启动系统了。后来仔细想想，这就是在不同质的电脑之间备份和恢复系统惹的祸。前面提过，我的 Dell XPS 15 的硬盘设备名是 /dev/nvme0n1p，而 Acer 的 SATA 硬盘的设备名是 /dev/sda，而且我的 Dell XPS 15 使用的是 EFI 方式安装的 Ubuntu，而 Acer 是用 Legacy BIOS 方式安装的 Ubuntu。这就是两台电脑不同质。")])]),s._v(" "),a("li",[a("p",[s._v("后来想了一下，即使是同质的电脑，直接使用 sudo time rsync -Pa /media/youxia/usb/backup_20160816/ /命令进行恢复，应该也是进不了系统，原因有二：")])]),s._v(" "),a("li",[a("p",[s._v("Grub在启动 Linux 内核的时候，是使用硬盘分区的 UUID 来寻找 Linux 内核的，即使是同质的电脑，其硬盘分区的 UUID 应该也不同；\n系统启动后，挂载文件系统的时候，也是使用硬盘分区的 UUID 来寻找硬盘分区的，具体内容可以查看/etc/fstab文件。所以两台电脑的硬盘分区的 UUID 不同，自然系统不能顺利运行。")])]),s._v(" "),a("li",[a("p",[s._v("所以我们在恢复系统的时候，不能简单的使用sudo time rsync -Pa /media/youxia/usb/backup_20160816/ /命令就完了，而是应该具体问题具体分析。如果能够定位到具体的目录，只恢复相应的目录应该是最好的，精准恢复，既节约时间，又避免副作用。")])]),s._v(" "),a("li",[a("p",[s._v("如果真的想全盘恢复的话，先想想 /boot 分区有无破坏，或 /boot/grub2/grub.cfg 这个配置文件有无受损，以及/etc/fstab文件是否有变动，如果没有的话，可以使用 --exclude=/boot/* 和 --exclude=/etc/fstab 选项来避免覆盖这些内容，应该是可以做到在不同的电脑之间互相备份和恢复。")])]),s._v(" "),a("li",[a("p",[s._v("但是最佳的做法，应该还是针对每一台电脑做一个单独的备份，而且是定期备份 ,有备无患。")])])]),s._v(" "),a("h2",{attrs:{id:"方案三：tar"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#方案三：tar"}},[s._v("#")]),s._v(" 方案三：tar")]),s._v(" "),a("blockquote",[a("p",[s._v("referred from:https://www.cnblogs.com/linuxde/p/8729457.html")])]),s._v(" "),a("h3",{attrs:{id:"备份-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#备份-2"}},[s._v("#")]),s._v(" 备份")]),s._v(" "),a("blockquote",[a("p",[s._v("和Windows不同，Linux不会限制root访问任何东西，你可以把分区上的所有东西都扔到一个TAR文件里去！")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('$ sudo su\n# unmount /dev/sdc1\n# mount /dev/sdc1 /mnt\n# tar cvpfz /mnt/cvpzf backup.tgz --exclude=/proc --exclude=/lost+found --exclude=/backup.tgz --exclude=/mnt –exclude=/sys /\n//或者可以集合在一起来写\n# tar cvpfz /mnt/fedora20180725.tgz --exclude={"/proc/*","/run/*","/mnt/*","/media/*","/sys/*","/lost+found","/dev/*","/tmp/*"}  /\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("解析：")]),s._v(" "),a("ul",[a("li",[s._v("tar：压缩程序")]),s._v(" "),a("li",[s._v("cvpfz：tar的选项，意思是“创建档案文件”、“保持权限”(保留所有东西原来的权限)、“使用gzip来减小文件尺寸”。")])]),s._v(" "),a("p",[s._v("备份文件本身必须排除在外，否则你可能会得到一些超出常理的结果。如果不把“/mnt/*”排 除在外，那么挂载在“/mnt”上的其它分区也会被备份。另外需要确认一下“/media”上没有挂载任何东西(例如光盘、移动硬盘)，如果有挂载东西， 必须把“/media”也排除在外")]),s._v(" "),a("p",[s._v("有人可能会建议你把“/dev”目录排除在外，但是我认为这样做很不妥，具体原因这里就不讨论了。")]),s._v(" "),a("p",[s._v("执行备份命令之前请再确认一下你所键入的命令是不是你想要的。执行备份命令可能需要一段不短的时间。")]),s._v(" "),a("p",[s._v("备份完成后，在文件系统的根目录将生成一个名为“backup.tgz”的文件，它的尺寸有可能非常大。现在你可以把它烧录到DVD上或者放到你认为安全的地方去。")]),s._v(" "),a("p",[s._v("在备份命令结束时你可能会看到这样一个提示：’tar: Error exit delayed from previous errors’，多数情况下你可以忽略它。")]),s._v(" "),a("p",[s._v("你还可以用Bzip2来压缩文件，Bzip2比gzip的压缩率高，但是速度慢一些。如果压缩率对你来说很重要，那么你应该使用Bzip2，用“j”代替命令中的“z”，并且给档案文件一个正确的扩展名“bz2”。完整的命令如下：")]),s._v(" "),a("blockquote",[a("p",[a("code",[s._v("# tar cvpfj backup.tar.bz2 –exclude=/proc –exclude=/lost+found –exclude=/backup.tar.bz2 –exclude=/mnt –exclude=/sys /")])])]),s._v(" "),a("h3",{attrs:{id:"恢复"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#恢复"}},[s._v("#")]),s._v(" 恢复")]),s._v(" "),a("p",[s._v("在进行恢复系统的操作时一定要小心！如果你不清楚自己在做什么，那么你有可能把重要的数据弄丢，请务必小心！")]),s._v(" "),a("p",[s._v("接着上面的例子。切换到root用户，并把文件“backup.tgz”拷贝到分区的根目录下。")]),s._v(" "),a("p",[s._v("在 Linux中有一件很美妙的事情，就是你可以在一个运行的系统中恢复系统，而不需要用boot-cd来专门引导。当然，如果你的系统已经挂掉不能启动了， 你可以用Live CD来启动，效果是一样的。你还可以用一个命令把Linux系统中的所有文件干掉，当然在这里我不打算给出这个命令！")]),s._v(" "),a("p",[s._v("使用下面的命令来恢复系统：")]),s._v(" "),a("blockquote",[a("p",[a("code",[s._v("# tar xvpfz backup.tgz -C /")])])]),s._v(" "),a("p",[s._v("如果你的档案文件是使用Bzip2压缩的，应该用：")]),s._v(" "),a("blockquote",[a("p",[a("code",[s._v("# tar xvpfj backup.tar.bz2 -C /")])])]),s._v(" "),a("p",[s._v("通过Live-CD:")]),s._v(" "),a("p",[s._v("操作之前请确保你已经有一个制作好的U盘启动盘。进入系统后，打开终端还是先切换到root。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("mkdir /mnt/sys\nmount /dev/sdaX /mnt/sys\ntar -xvpzf /media/myDisk/ubuntu_boot_backup@2016-6-6.tar.gz -C /mnt/sys\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("blockquote",[a("p",[s._v("因为 tar还原是只会覆盖相同的文件，但是这种方法只是恢复备份时的文件，就是说如果某些文件丢失或损坏了，这样可以恢复修复这些文件，但不能删除自备份到恢复前这期间所生成的其它文件，说白了就是假如你备份系统时有1234这四个文件，如果三天后，由于某些原因变成了1234’5（4改变了），你恢复后，就会变成12345，其中4’恢复成备份时的文件，5保留。所以大家要是想彻底还原成备份时候的样子最好彻底删除根目录下的所有文件，然后再还原，这样就可以还原成备份时的样子了。")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("删除整个文件系统，比如运行命令\nrm -fr /*\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("mkdir proc tmp lost+found media mnt run")]),s._v(" "),a("p",[s._v("恢复命令结束时，你的工作还没完成，别忘了重新创建那些在备份时被排除在外的目录：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("# mkdir proc\n# mkdir lost+found\n# mkdir mnt\n# mkdir sys\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h2",{attrs:{id:"方案四：dump"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#方案四：dump"}},[s._v("#")]),s._v(" 方案四：dump")]),s._v(" "),a("h3",{attrs:{id:"备份dump"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#备份dump"}},[s._v("#")]),s._v(" 备份dump")]),s._v(" "),a("blockquote",[a("p",[s._v("使用dump命令时，它会建立一份自上次备份操作以来进行修改过的文件列表，然后把这些文件打包成一个单独的文件。在做备份时，需要指定一个备份级别，它是0-9之间的一个整数。级别为N的转储会对从上次进行的级别小于N的转储操作以来修改过的所有文件进行备份，而级别0就是完全备份。通过这种方式，可以很轻松的实现增量备份，差异备份，甚至每日备份。例如，第一次备份时可选择级别0（具体操作看后面），以后每天做增量备份时就可以每天依次使用级别1，级别2，级别3等等… …；当需要每天做差异备份时，可先选择级别0做完整备份，然后每天都使用同一大于0的级别就行了，比如说第二天用5，第三天也用5，第四天也一样。")])]),s._v(" "),a("p",[a("code",[s._v("dump [-cnu][-0123456789][-b <区块大小>][-B <区块数目>][-d <密度>][-f <设备名称>][-h <层级>][-s <磁带长度>][-T <日期>][目录或文件系统] 或 dump [-wW]")])]),s._v(" "),a("p",[s._v("参数：")]),s._v(" "),a("ul",[a("li",[s._v("-0123456789 　备份的层级。")]),s._v(" "),a("li",[s._v("-b<区块大小> 　指定区块的大小，单位为KB，默认为10")]),s._v(" "),a("li",[s._v("-B<区块数目> 　指定备份卷册的区块数目（有些磁带不支持以结束标志判断时，就需要使用到此参数）")]),s._v(" "),a("li",[s._v("-c 　修改备份磁带预设的密度与容量。")]),s._v(" "),a("li",[s._v("-d<密度> 　设置磁带的密度。单位为BPI，默认为1600BPI")]),s._v(" "),a("li",[s._v("-f<设备名称> 　指定备份设备，后接产生得文件名,也可接/dev/st0设备文件名等")]),s._v(" "),a("li",[s._v('-h<层级> 　当备份层级等于或大于指定的层级时，将不备份用户标示为"nodump"的文件。')]),s._v(" "),a("li",[s._v('-n 　当备份工作需要管理员介入时，向所有"operator"群组中的使用者发出通知。')]),s._v(" "),a("li",[s._v("-s   统计备份所需的空间，一般在备份前做，以防磁带或磁盘空间不足")]),s._v(" "),a("li",[s._v("-T<日期> 　指定开始备份的时间与日期。")]),s._v(" "),a("li",[s._v("-u 　备份完毕后，在/etc/dumpdates中记录备份的文件系统，层级，日期与时间等，如果从来都不使用-u参数，那么所有的存储都会变为级别0。因为，系统不会有先前备份过当前文件系统的记录。")]),s._v(" "),a("li",[s._v("-w 　与-W类似，但仅显示需要备份的文件。")]),s._v(" "),a("li",[s._v("-W 　显示需要备份的文件及其最后一次备份的层级，时间与日期。")]),s._v(" "),a("li",[s._v("-D   设定存储数据库的名称和路径，默认是/etc/dumpdates文件")]),s._v(" "),a("li",[s._v("-e，-E：与备份文件的inodes数有关的参数")]),s._v(" "),a("li",[s._v("-j  加入bzip2的支持!将数据进行压缩,默认bzip2的压缩等级为2;")])]),s._v(" "),a("blockquote",[a("p",[s._v("注：")]),s._v(" "),a("ul",[a("li",[s._v("当备份为一个独立的文件系统(独立的分区)时，可以使用-u，如果只是备份目录下的文件时，不能使用-u")]),s._v(" "),a("li",[s._v("当备份为一个独立的文件系统(独立的分区)时，可以使用多层级备份。如果只是备份目录下的文件时，只能使用-0")]),s._v(" "),a("li",[s._v("压缩文件的时候一定要标明压缩格式（即标明压缩文件名称后面的诸如“.bz2”的信息），避免事后需要手工解压缩的时候因为不清楚压缩格式而造成解压过程的繁琐。")])])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("dump –0s /dev/sda1\n\n完整备份/dev/sda1前统计一下需多大容量\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("[root@localhost~]# dump -0j -f /root/etc.dump.bz2 /etc/\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("备份文件到磁带\n\n\n# dump -0 -u /dev/tape /home/\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("[root@localhost~]# cat /etc/dumpdates\n\n查看备份时间文件，了解文件是在什么时间进行备份的，也就是每次执行dump操作的具体时间。\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("[root@localhost~]# dump -W\n查询整个分区的备份时间及备份级别的详细信息\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h3",{attrs:{id:"还原restore"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#还原restore"}},[s._v("#")]),s._v(" 还原restore")]),s._v(" "),a("p",[s._v("dump的逆向命令，用来还原备份的文件")]),s._v(" "),a("ul",[a("li",[s._v("-t：此模式用在观察dump备份中含有什么重要数据，类似tar -t功能")]),s._v(" "),a("li",[s._v("-C：此模式可以将dump内的数据拿出来跟实际的文件系统做比较，最终会列出在dump档案内有记录的，且目前文件系统不一样的档案")]),s._v(" "),a("li",[s._v("-i：进入互动模式，可以仅还原部分档案，用在dump目录备份还原，进入互动模式，可以通过help命令来查看帮助手册")]),s._v(" "),a("li",[s._v("-r：用在针对还原整个文件系统的dump备份")]),s._v(" "),a("li",[s._v("-h：查看完整备份数中的inode与文件系统label等信息")]),s._v(" "),a("li",[s._v("-f：接要处理的那个dump档案")]),s._v(" "),a("li",[s._v("-D：与-C进行搭配，可以查出后面接的挂载点与dump内有不同的档")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("dump -0f  /tmp/user.bak  /home/ubuntu\nrestore -f  /tmp/user.bak  /home/ubuntu\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("查看备份文件中的内容\n\nrestore -tf /tmp/user.bak\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("[root@localhost~]#restore -C -f /root/boot.bak.bz2\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("[root@localhost~]#mkdir bootbak\n[root@localhost~]#cd bootbak/\n[root@localhostbootbak]# restore -r -f /root/boot.bak.bz2\n/boot分区的数据文件全部解压到当前目录下了(相当于一个解压缩命令)\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h2",{attrs:{id:"clonezilla"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#clonezilla"}},[s._v("#")]),s._v(" Clonezilla")]),s._v(" "),a("h2",{attrs:{id:"各种方案的比较"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#各种方案的比较"}},[s._v("#")]),s._v(" 各种方案的比较")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("类型")]),s._v(" "),a("th",[s._v("dd")]),s._v(" "),a("th",[s._v("rsync")]),s._v(" "),a("th",[s._v("tar")]),s._v(" "),a("th",[s._v("dump")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("优点1")]),s._v(" "),a("td",{attrs:{rowspan:"8",colspan:"2"}}),s._v(" "),a("td",{attrs:{rowspan:"6"}}),s._v(" "),a("td",[s._v("备份可以跨多卷磁带")])]),s._v(" "),a("tr",[a("td",[s._v("优点2")]),s._v(" "),a("td",[s._v("能备份任何类型的文件，甚至是设备（ext）")])]),s._v(" "),a("tr",[a("td",[s._v("优点3")]),s._v(" "),a("td",[s._v("文件的权限、宿主、宿组、修改时间等都会被保存")])]),s._v(" "),a("tr",[a("td",[s._v("优点4")]),s._v(" "),a("td",[s._v("能够正确处理从未包含任何数据的文件块（孔洞文件）")])]),s._v(" "),a("tr",[a("td",[s._v("优点5")]),s._v(" "),a("td",[s._v("能够做增量，差异备份")])]),s._v(" "),a("tr",[a("td"),s._v(" "),a("td")]),s._v(" "),a("tr",[a("td",[s._v("不足1")]),s._v(" "),a("td",[s._v("只能在Linux或Unix环境下使用")]),s._v(" "),a("td",[s._v("每个文件系统必须单独转储备份")])]),s._v(" "),a("tr",[a("td",[s._v("不足2")]),s._v(" "),a("td"),s._v(" "),a("td",[s._v("只有本地计算机的文件系统才能够转储备份（rdump，rrestore可用来弥补此项不足）")])])])])])}),[],!1,null,null,null);t.default=v.exports}}]);