(window.webpackJsonp=window.webpackJsonp||[]).push([[48],{462:function(t,e,r){"use strict";r.r(e);var s=r(6),a=Object(s.a)({},(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[r("h1",{attrs:{id:"lvm"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#lvm"}},[t._v("#")]),t._v(" LVM")]),t._v(" "),r("blockquote",[r("p",[t._v("本文由 "),r("a",{attrs:{href:"http://ksria.com/simpread/",target:"_blank",rel:"noopener noreferrer"}},[t._v("简悦 SimpRead"),r("OutboundLink")],1),t._v(" 转码， 原文地址 https://www.cnblogs.com/mchina/p/linux-centos-logical-volume-manager-lvm.html")])]),t._v(" "),r("h1",{attrs:{id:"centos-6-3-下配置-lvm（逻辑卷管理）"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#centos-6-3-下配置-lvm（逻辑卷管理）"}},[t._v("#")]),t._v(" "),r("a",{attrs:{href:"https://www.cnblogs.com/mchina/p/linux-centos-logical-volume-manager-lvm.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("CentOS 6.3 下配置 LVM（逻辑卷管理）"),r("OutboundLink")],1)]),t._v(" "),r("p",[r("strong",[t._v("一、简介")])]),t._v(" "),r("p",[t._v("LVM 是逻辑盘卷管理（Logical Volume Manager）的简称，它是 Linux 环境下对磁盘分区进行管理的一种机制，LVM 是建立在硬盘和分区之上的一个逻辑层，来提高磁盘分区管理的灵活性。")]),t._v(" "),r("p",[t._v("LVM 的工作原理其实很简单，它就是通过将底层的物理硬盘抽象的封装起来，然后以逻辑卷的方式呈现给上层应用。在传统的磁盘管理机制中，我们的上层应用是直接访问文件系统，从而对底层的物理硬盘进行读取，而在 LVM 中，其通过对底层的硬盘进行封装，当我们对底层的物理硬盘进行操作时，其不再是针对于分区进行操作，而是通过一个叫做逻辑卷的东西来对其进行底层的磁盘管理操作。比如说我增加一个物理硬盘，这个时候上层的服务是感觉不到的，因为呈现给上层服务的是以逻辑卷的方式。")]),t._v(" "),r("p",[t._v("LVM 最大的特点就是可以对磁盘进行动态管理。因为逻辑卷的大小是可以动态调整的，而且不会丢失现有的数据。如果我们新增加了硬盘，其也不会改变现有上层的逻辑卷。作为一个动态磁盘管理机制，逻辑卷技术大大提高了磁盘管理的灵活性。")]),t._v(" "),r("p",[r("strong",[t._v("基本的逻辑卷管理概念：")])]),t._v(" "),r("p",[t._v("PV（Physical Volume）- 物理卷\n物理卷在逻辑卷管理中处于最底层，它可以是实际物理硬盘上的"),r("strong",[t._v("分区")]),t._v("，也可以是整个"),r("strong",[t._v("物理硬盘")]),t._v("，也可以是 "),r("strong",[t._v("raid 设备")]),t._v("。")]),t._v(" "),r("p",[t._v("VG（Volumne Group）- 卷组\n卷组建立在物理卷之上，一个卷组中至少要包括一个物理卷，在卷组建立之后可动态添加物理卷到卷组中。一个逻辑卷管理系统工程中可以只有一个卷组，也可以拥有多个卷组。")]),t._v(" "),r("p",[t._v("LV（Logical Volume）- 逻辑卷\n逻辑卷建立在卷组之上，卷组中的未分配空间可以用于建立新的逻辑卷，逻辑卷建立后可以动态地扩展和缩小空间。系统中的多个逻辑卷可以属于同一个卷组，也可以属于不同的多个卷组。")]),t._v(" "),r("p",[t._v("关系图如下：")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://images0.cnblogs.com/blog/370046/201406/171413282394354.jpg",target:"_blank",rel:"noopener noreferrer"}},[r("img",{attrs:{src:"https://images0.cnblogs.com/blog/370046/201406/171413290825011.jpg",alt:""}}),r("OutboundLink")],1)]),t._v(" "),r("p",[t._v("PE（Physical Extent）- 物理块")]),t._v(" "),r("p",[t._v("LVM 默认使用 4MB 的 PE 区块，而 LVM 的 LV 最多仅能含有 65534 个 PE (lvm1 的格式)，因此默认的 LVM 的 LV 最大容量为 4M*65534/(1024M/G)=256G。PE 是整个 LVM 最小的储存区块，也就是说，其实我们的资料都是由写入 PE 来处理的。简单的说，这个 PE 就有点像文件系统里面的 block 大小。所以调整 PE 会影响到 LVM 的最大容量！不过，在 CentOS 6.x 以后，由于直接使用 lvm2 的各项格式功能，因此这个限制已经不存在了。")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://images0.cnblogs.com/blog/370046/201406/171413294737298.gif",target:"_blank",rel:"noopener noreferrer"}},[r("img",{attrs:{src:"https://images0.cnblogs.com/blog/370046/201406/171413298796356.gif",alt:""}}),r("OutboundLink")],1)]),t._v(" "),r("p",[r("strong",[t._v("二、系统环境")])]),t._v(" "),r("p",[t._v("**实验环境：**Oracle VM VirtualBox")]),t._v(" "),r("p",[t._v("**系统平台：**CentOS release 6.3 (Final)")]),t._v(" "),r("p",[t._v("**mdadm 版本：**mdadm - v3.2.6 - 25th October 2012")]),t._v(" "),r("p",[t._v("**LVM 版本：**lvm2-2.02.100-8.el6.i686")]),t._v(" "),r("p",[t._v("**设备类型：**分区、物理硬盘、raid 设备")]),t._v(" "),r("p",[r("strong",[t._v("三、磁盘准备")])]),t._v(" "),r("p",[t._v("在这篇文章中，我们将模拟 raid5、分区、物理硬盘三种类型设备创建 VG，raid5 需要四块硬盘，分区和物理硬盘各一块硬盘，还有扩容时需要至少一块硬盘，所以在虚拟机里添加八块硬盘，每块 5GB.")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://images0.cnblogs.com/blog/370046/201406/171413305672499.jpg",target:"_blank",rel:"noopener noreferrer"}},[r("img",{attrs:{src:"https://images0.cnblogs.com/blog/370046/201406/171413315369427.jpg",alt:""}}),r("OutboundLink")],1)]),t._v(" "),r("p",[r("strong",[t._v("四、安装 LVM 管理工具")])]),t._v(" "),r("p",[t._v("4.1 检查系统中是否安装了 LVM 管理工具")]),t._v(" "),r("h1",{attrs:{id:"rpm-qa-grep-lvm"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#rpm-qa-grep-lvm"}},[t._v("#")]),t._v(" rpm -qa|grep lvm")]),t._v(" "),r("p",[t._v("4.2 如果未安装，则使用 yum 方式安装")]),t._v(" "),r("h1",{attrs:{id:"yum-install-lvm"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#yum-install-lvm"}},[t._v("#")]),t._v(" yum install lvm*")]),t._v(" "),r("h1",{attrs:{id:"rpm-qa-grep-lvm-2"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#rpm-qa-grep-lvm-2"}},[t._v("#")]),t._v(" rpm -qa|grep lvm")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://images0.cnblogs.com/blog/370046/201406/171413322705286.jpg",target:"_blank",rel:"noopener noreferrer"}},[r("img",{attrs:{src:"https://images0.cnblogs.com/blog/370046/201406/171413328324157.jpg",alt:""}}),r("OutboundLink")],1)]),t._v(" "),r("p",[r("strong",[t._v("五、新建一个 raid5 设备")])]),t._v(" "),r("p",[t._v("使用 / dev/sdb, /dev/sdc, /dev/sdd, /dev/sde 四块物理硬盘做软 raid 模拟。")]),t._v(" "),r("h1",{attrs:{id:"mdadm-c-dev-md5-ayes-l5-n3-x1-dev-sd-b-c-d-e"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#mdadm-c-dev-md5-ayes-l5-n3-x1-dev-sd-b-c-d-e"}},[t._v("#")]),t._v(" mdadm -C /dev/md5 -ayes -l5 -n3 -x1 /dev/sd[b,c,d,e]")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://images0.cnblogs.com/blog/370046/201406/171413334578514.jpg",target:"_blank",rel:"noopener noreferrer"}},[r("img",{attrs:{src:"https://images0.cnblogs.com/blog/370046/201406/171413340368858.jpg",alt:""}}),r("OutboundLink")],1)]),t._v(" "),r("p",[t._v("写入 RAID 配置文件 / etc/mdadm.conf 并做适当修改。")]),t._v(" "),r("h1",{attrs:{id:"echo-device-dev-sd-b-c-d-e-etc-mdadm-conf"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#echo-device-dev-sd-b-c-d-e-etc-mdadm-conf"}},[t._v("#")]),t._v(" echo DEVICE /dev/sd{b,c,d,e} >> /etc/mdadm.conf")]),t._v(" "),r("h1",{attrs:{id:"mdadm-ds-etc-mdadm-conf"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#mdadm-ds-etc-mdadm-conf"}},[t._v("#")]),t._v(" mdadm –Ds >> /etc/mdadm.conf")]),t._v(" "),r("p",[t._v("详细请参考上篇文章："),r("a",{attrs:{href:"http://www.cnblogs.com/mchina/p/linux-centos-disk-array-software_raid.html",title:"http://www.cnblogs.com/mchina/p/linux-centos-disk-array-software_raid.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://www.cnblogs.com/mchina/p/linux-centos-disk-array-software_raid.html"),r("OutboundLink")],1)]),t._v(" "),r("p",[r("strong",[t._v("六、新建一个分区")])]),t._v(" "),r("p",[t._v("使用 / dev/sdf 模拟分区。")]),t._v(" "),r("h1",{attrs:{id:"fdisk-dev-sdf"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#fdisk-dev-sdf"}},[t._v("#")]),t._v(" fdisk /dev/sdf")]),t._v(" "),r("h1",{attrs:{id:"fdisk-l-dev-sdf"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#fdisk-l-dev-sdf"}},[t._v("#")]),t._v(" fdisk -l /dev/sdf")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://images0.cnblogs.com/blog/370046/201406/171413348795217.jpg",target:"_blank",rel:"noopener noreferrer"}},[r("img",{attrs:{src:"https://images0.cnblogs.com/blog/370046/201406/171413359896188.jpg",alt:""}}),r("OutboundLink")],1)]),t._v(" "),r("p",[t._v("准备工作就绪，下面我们使用三种设备 / dev/md5、/dev/sdf1、/dev/sdg 来完成 LVM 实验。")]),t._v(" "),r("p",[r("strong",[t._v("七、创建 PV")])]),t._v(" "),r("h1",{attrs:{id:"pvcreate-dev-md5-dev-sdf1-dev-sdg"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#pvcreate-dev-md5-dev-sdf1-dev-sdg"}},[t._v("#")]),t._v(" pvcreate /dev/md5 /dev/sdf1 /dev/sdg")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://images0.cnblogs.com/blog/370046/201406/171413368645089.jpg",target:"_blank",rel:"noopener noreferrer"}},[r("img",{attrs:{src:"https://images0.cnblogs.com/blog/370046/201406/171413374117189.jpg",alt:""}}),r("OutboundLink")],1)]),t._v(" "),r("p",[t._v("查看 PV")]),t._v(" "),r("h1",{attrs:{id:"pvdisplay"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#pvdisplay"}},[t._v("#")]),t._v(" pvdisplay")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://images0.cnblogs.com/blog/370046/201406/171413381144804.jpg",target:"_blank",rel:"noopener noreferrer"}},[r("img",{attrs:{src:"https://images0.cnblogs.com/blog/370046/201406/171413389111448.jpg",alt:""}}),r("OutboundLink")],1)]),t._v(" "),r("p",[t._v("还可以使用命令 pvs 和 pvscan 查看简略信息。")]),t._v(" "),r("h1",{attrs:{id:"pvs"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#pvs"}},[t._v("#")]),t._v(" pvs")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://images0.cnblogs.com/blog/370046/201406/171413395043264.jpg",target:"_blank",rel:"noopener noreferrer"}},[r("img",{attrs:{src:"https://images0.cnblogs.com/blog/370046/201406/171413413327620.jpg",alt:""}}),r("OutboundLink")],1)]),t._v(" "),r("h1",{attrs:{id:"pvscan"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#pvscan"}},[t._v("#")]),t._v(" pvscan")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://images0.cnblogs.com/blog/370046/201406/171413433173194.jpg",target:"_blank",rel:"noopener noreferrer"}},[r("img",{attrs:{src:"https://images0.cnblogs.com/blog/370046/201406/171413442861123.jpg",alt:""}}),r("OutboundLink")],1)]),t._v(" "),r("p",[r("strong",[t._v("八、创建 VG")])]),t._v(" "),r("h1",{attrs:{id:"vgcreate-vg0-dev-md5-dev-sdf1-dev-sdg"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#vgcreate-vg0-dev-md5-dev-sdf1-dev-sdg"}},[t._v("#")]),t._v(" vgcreate vg0 /dev/md5 /dev/sdf1 /dev/sdg")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://images0.cnblogs.com/blog/370046/201406/171413461615196.jpg",target:"_blank",rel:"noopener noreferrer"}},[r("img",{attrs:{src:"https://images0.cnblogs.com/blog/370046/201406/171413479738483.jpg",alt:""}}),r("OutboundLink")],1)]),t._v(" "),r("p",[t._v("**说明：**vg0 是创建的 VG 设备的名称，可以随便取；后面接上述的三个设备，也就是把三个设备组合成一个 vg0.")]),t._v(" "),r("p",[t._v("查看 VG")]),t._v(" "),r("h1",{attrs:{id:"vgdisplay"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#vgdisplay"}},[t._v("#")]),t._v(" vgdisplay")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://images0.cnblogs.com/blog/370046/201406/171413486457855.jpg",target:"_blank",rel:"noopener noreferrer"}},[r("img",{attrs:{src:"https://images0.cnblogs.com/blog/370046/201406/171413493177227.jpg",alt:""}}),r("OutboundLink")],1)]),t._v(" "),r("p",[r("strong",[t._v("说明：")])]),t._v(" "),r("p",[t._v("VG Name　　VG 的名称")]),t._v(" "),r("p",[t._v("VG Size　　VG 的总大小")]),t._v(" "),r("p",[t._v("PE Size　　PE 的大小，默认为 4MB")]),t._v(" "),r("p",[t._v("Total PE　　PE 的总数量，5114 x 4MB = 19.98GB")]),t._v(" "),r("p",[t._v("Free PE / Size　　剩余空间大小")]),t._v(" "),r("p",[t._v("同样可以使用命令 vgs 和 vgscan 查看。")]),t._v(" "),r("h1",{attrs:{id:"vgs"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#vgs"}},[t._v("#")]),t._v(" vgs")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://images0.cnblogs.com/blog/370046/201406/171413499114342.jpg",target:"_blank",rel:"noopener noreferrer"}},[r("img",{attrs:{src:"https://images0.cnblogs.com/blog/370046/201406/171413503798886.jpg",alt:""}}),r("OutboundLink")],1)]),t._v(" "),r("h1",{attrs:{id:"vgscan"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#vgscan"}},[t._v("#")]),t._v(" vgscan")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://images0.cnblogs.com/blog/370046/201406/171413508796972.jpg",target:"_blank",rel:"noopener noreferrer"}},[r("img",{attrs:{src:"https://images0.cnblogs.com/blog/370046/201406/171413513325342.jpg",alt:""}}),r("OutboundLink")],1)]),t._v(" "),r("p",[r("strong",[t._v("九、创建 LV")])]),t._v(" "),r("h1",{attrs:{id:"lvcreate-l-5g-n-lv1-vg0"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#lvcreate-l-5g-n-lv1-vg0"}},[t._v("#")]),t._v(" lvcreate -L 5G -n lv1 vg0")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://images0.cnblogs.com/blog/370046/201406/171413517868414.jpg",target:"_blank",rel:"noopener noreferrer"}},[r("img",{attrs:{src:"https://images0.cnblogs.com/blog/370046/201406/171413544115116.jpg",alt:""}}),r("OutboundLink")],1)]),t._v(" "),r("p",[r("strong",[t._v("说明：")])]),t._v(" "),r("p",[t._v("-L    指定创建的 LV 的大小\n-l    指定创建的 LV 的 PE 数量\n-n    LV 的名字\n上面命令的意思是：从 vg0 中分出 5G 的空间给 lv1 使用")]),t._v(" "),r("p",[t._v("查看 LV 的信息")]),t._v(" "),r("h1",{attrs:{id:"lvdisplay"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#lvdisplay"}},[t._v("#")]),t._v(" lvdisplay")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://images0.cnblogs.com/blog/370046/201406/171413550985960.jpg",target:"_blank",rel:"noopener noreferrer"}},[r("img",{attrs:{src:"https://images0.cnblogs.com/blog/370046/201406/171413557862103.jpg",alt:""}}),r("OutboundLink")],1)]),t._v(" "),r("p",[r("strong",[t._v("说明：")])]),t._v(" "),r("p",[t._v("LV Path　　LV 的路径，全名")]),t._v(" "),r("p",[t._v("LV Name　　LV 的名字")]),t._v(" "),r("p",[t._v("VG Name　　所属的 VG")]),t._v(" "),r("p",[t._v("LV Size　　LV 的大小")]),t._v(" "),r("p",[t._v("再来看 VG 的信息")]),t._v(" "),r("h1",{attrs:{id:"vgs-2"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#vgs-2"}},[t._v("#")]),t._v(" vgs")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://images0.cnblogs.com/blog/370046/201406/171413562703418.jpg",target:"_blank",rel:"noopener noreferrer"}},[r("img",{attrs:{src:"https://images0.cnblogs.com/blog/370046/201406/171413568018747.jpg",alt:""}}),r("OutboundLink")],1)]),t._v(" "),r("p",[t._v("VFree 从 19.98g 减少到了 14.98g，另外的 5g 被分配到了 lv1.")]),t._v(" "),r("p",[r("strong",[t._v("十、格式化 LV")])]),t._v(" "),r("h1",{attrs:{id:"mkfs-ext4-dev-vg0-lv1"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#mkfs-ext4-dev-vg0-lv1"}},[t._v("#")]),t._v(" mkfs.ext4 /dev/vg0/lv1")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://images0.cnblogs.com/blog/370046/201406/171413576767648.jpg",target:"_blank",rel:"noopener noreferrer"}},[r("img",{attrs:{src:"https://images0.cnblogs.com/blog/370046/201406/171413584572819.jpg",alt:""}}),r("OutboundLink")],1)]),t._v(" "),r("p",[r("strong",[t._v("十一、挂载使用")])]),t._v(" "),r("h1",{attrs:{id:"mkdir-mnt-lv1"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#mkdir-mnt-lv1"}},[t._v("#")]),t._v(" mkdir /mnt/lv1")]),t._v(" "),r("h1",{attrs:{id:"mount-dev-vg0-lv1-mnt-lv1"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#mount-dev-vg0-lv1-mnt-lv1"}},[t._v("#")]),t._v(" mount /dev/vg0/lv1 /mnt/lv1/")]),t._v(" "),r("h1",{attrs:{id:"df-th"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#df-th"}},[t._v("#")]),t._v(" df –TH")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://images0.cnblogs.com/blog/370046/201406/171413591453663.jpg",target:"_blank",rel:"noopener noreferrer"}},[r("img",{attrs:{src:"https://images0.cnblogs.com/blog/370046/201406/171413598798521.jpg",alt:""}}),r("OutboundLink")],1)]),t._v(" "),r("p",[t._v("将挂载信息写入 / etc/fstab")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://images0.cnblogs.com/blog/370046/201406/171414007395950.jpg",target:"_blank",rel:"noopener noreferrer"}},[r("img",{attrs:{src:"https://images0.cnblogs.com/blog/370046/201406/171414014579335.jpg",alt:""}}),r("OutboundLink")],1)]),t._v(" "),r("p",[r("strong",[t._v("十二、添加测试数据")])]),t._v(" "),r("p",[t._v("下面我们将对 LVM 进行扩容和缩减操作，所以向 / mnt/lv1 中写入测试数据以验证 LVM 的磁盘动态管理。")]),t._v(" "),r("h1",{attrs:{id:"touch-mnt-lv1-test-lvm-dynamic-disk"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#touch-mnt-lv1-test-lvm-dynamic-disk"}},[t._v("#")]),t._v(" touch /mnt/lv1/test_lvm_dynamic.disk")]),t._v(" "),r("h1",{attrs:{id:"touch-mnt-lv1-test-lvm-dynamic-disk2"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#touch-mnt-lv1-test-lvm-dynamic-disk2"}},[t._v("#")]),t._v(" touch /mnt/lv1/test_lvm_dynamic.disk2")]),t._v(" "),r("h1",{attrs:{id:"touch-mnt-lv1-test-lvm-dynamic-disk3"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#touch-mnt-lv1-test-lvm-dynamic-disk3"}},[t._v("#")]),t._v(" touch /mnt/lv1/test_lvm_dynamic.disk3")]),t._v(" "),r("h1",{attrs:{id:"ll-mnt-lv1"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#ll-mnt-lv1"}},[t._v("#")]),t._v(" ll /mnt/lv1/")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://images0.cnblogs.com/blog/370046/201406/171414022541681.jpg",target:"_blank",rel:"noopener noreferrer"}},[r("img",{attrs:{src:"https://images0.cnblogs.com/blog/370046/201406/171414031456352.jpg",alt:""}}),r("OutboundLink")],1)]),t._v(" "),r("p",[r("strong",[t._v("十三、LVM 的扩容操作")])]),t._v(" "),r("p",[t._v("LVM 最大的好处就是可以对磁盘进行动态管理，而且不会丢失现有的数据。")]),t._v(" "),r("p",[t._v("假如有一天，lv1 的使用量达到了 80%，需要扩容，那我们该怎么做呢？")]),t._v(" "),r("p",[t._v("因为 vg0 中还有很多剩余空间，所以我们可以从 vg0 中再分配点空间给 lv1。")]),t._v(" "),r("p",[r("strong",[t._v("13.1 LV 的扩容")])]),t._v(" "),r("p",[t._v("查看 vg0 的剩余容量，还有 14.98g 可用。")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://images0.cnblogs.com/blog/370046/201406/171414038649737.jpg",target:"_blank",rel:"noopener noreferrer"}},[r("img",{attrs:{src:"https://images0.cnblogs.com/blog/370046/201406/171414043173810.jpg",alt:""}}),r("OutboundLink")],1)]),t._v(" "),r("p",[t._v("对 lv1 进行扩容。")]),t._v(" "),r("h1",{attrs:{id:"lvextend-l-1g-dev-vg0-lv1"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#lvextend-l-1g-dev-vg0-lv1"}},[t._v("#")]),t._v(" lvextend -L +1G /dev/vg0/lv1")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://images0.cnblogs.com/blog/370046/201406/171414047706882.jpg",target:"_blank",rel:"noopener noreferrer"}},[r("img",{attrs:{src:"https://images0.cnblogs.com/blog/370046/201406/171414052861739.jpg",alt:""}}),r("OutboundLink")],1)]),t._v(" "),r("p",[t._v("**说明：**在 lv1 原有的基础上增加了 1G.")]),t._v(" "),r("p",[t._v("查看现在 vg0 的剩余容量，减少了 1G.")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://images0.cnblogs.com/blog/370046/201406/171414057238039.jpg",target:"_blank",rel:"noopener noreferrer"}},[r("img",{attrs:{src:"https://images0.cnblogs.com/blog/370046/201406/171414061762112.jpg",alt:""}}),r("OutboundLink")],1)]),t._v(" "),r("p",[t._v("再查看 lv1 的容量，从 5G 增加到了 6G.")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://images0.cnblogs.com/blog/370046/201406/171414066143711.jpg",target:"_blank",rel:"noopener noreferrer"}},[r("img",{attrs:{src:"https://images0.cnblogs.com/blog/370046/201406/171414070676783.jpg",alt:""}}),r("OutboundLink")],1)]),t._v(" "),r("p",[t._v("使用 df –TH 命令查看实际的磁盘容量。")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://images0.cnblogs.com/blog/370046/201406/171414075821640.jpg",target:"_blank",rel:"noopener noreferrer"}},[r("img",{attrs:{src:"https://images0.cnblogs.com/blog/370046/201406/171414081763456.jpg",alt:""}}),r("OutboundLink")],1)]),t._v(" "),r("p",[t._v("发现实际容量并没有变化，因为我们的系统还不认识刚刚添加进来的磁盘的文件系统，所以还需要对文件系统进行扩容。")]),t._v(" "),r("h1",{attrs:{id:"resize2fs-dev-vg0-lv1"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#resize2fs-dev-vg0-lv1"}},[t._v("#")]),t._v(" resize2fs /dev/vg0/lv1")]),t._v(" "),r("h1",{attrs:{id:"df-th-2"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#df-th-2"}},[t._v("#")]),t._v(" df –TH")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://images0.cnblogs.com/blog/370046/201406/171414088321356.jpg",target:"_blank",rel:"noopener noreferrer"}},[r("img",{attrs:{src:"https://images0.cnblogs.com/blog/370046/201406/171414096292701.jpg",alt:""}}),r("OutboundLink")],1)]),t._v(" "),r("p",[t._v("现在的可用容量已经增加到了 5.9G。")]),t._v(" "),r("p",[t._v("查看测试数据")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://images0.cnblogs.com/blog/370046/201406/171414102395585.jpg",target:"_blank",rel:"noopener noreferrer"}},[r("img",{attrs:{src:"https://images0.cnblogs.com/blog/370046/201406/171414108484172.jpg",alt:""}}),r("OutboundLink")],1)]),t._v(" "),r("p",[t._v("数据正常，对 lv1 的在线动态扩容完成。")]),t._v(" "),r("p",[t._v("还有一种情况，就是假如我们的 vg0 空间不够用了，怎么办？这时我们就需要对 VG 进行扩容。")]),t._v(" "),r("p",[r("strong",[t._v("13.2 VG 的扩容")])]),t._v(" "),r("p",[t._v("VG 的扩容可以有两种方法，第一种方法是通过增加 PV 来实现，操作如下：")]),t._v(" "),r("p",[t._v("A. 创建 PV，使用 / dev/sdh 来创建一个 PV。")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://images0.cnblogs.com/blog/370046/201406/171414113329785.jpg",target:"_blank",rel:"noopener noreferrer"}},[r("img",{attrs:{src:"https://images0.cnblogs.com/blog/370046/201406/171414117707087.jpg",alt:""}}),r("OutboundLink")],1)]),t._v(" "),r("p",[t._v("B. 扩容 VG")]),t._v(" "),r("p",[t._v("现在的 vg0 容量为 19.98g.")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://images0.cnblogs.com/blog/370046/201406/171414122078686.jpg",target:"_blank",rel:"noopener noreferrer"}},[r("img",{attrs:{src:"https://images0.cnblogs.com/blog/370046/201406/171414127076772.jpg",alt:""}}),r("OutboundLink")],1)]),t._v(" "),r("h1",{attrs:{id:"vgextend-vg0-dev-sdh"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#vgextend-vg0-dev-sdh"}},[t._v("#")]),t._v(" vgextend vg0 /dev/sdh")]),t._v(" "),r("h1",{attrs:{id:"vgs-3"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#vgs-3"}},[t._v("#")]),t._v(" vgs")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://images0.cnblogs.com/blog/370046/201406/171414132544575.jpg",target:"_blank",rel:"noopener noreferrer"}},[r("img",{attrs:{src:"https://images0.cnblogs.com/blog/370046/201406/171414138647459.jpg",alt:""}}),r("OutboundLink")],1)]),t._v(" "),r("p",[t._v("现在 vg0 的容量为 24.97g, 增加了 5GB，即一块物理硬盘的容量，VG 扩容成功。")]),t._v(" "),r("p",[t._v("第二种方法是通过扩展 RAID 设备的容量来间接对 VG 进行扩容。这种方法在上一篇文章中有介绍，这里不再赘述，需要注意的地方是，/dev/md5 的大小变化后，需要调整 PV 的大小，操作如下：")]),t._v(" "),r("h1",{attrs:{id:"pvresize-dev-md5"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#pvresize-dev-md5"}},[t._v("#")]),t._v(" pvresize /dev/md5")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://images0.cnblogs.com/blog/370046/201406/171414147861375.jpg",target:"_blank",rel:"noopener noreferrer"}},[r("img",{attrs:{src:"https://images0.cnblogs.com/blog/370046/201406/171414153019932.jpg",alt:""}}),r("OutboundLink")],1)]),t._v(" "),r("p",[r("strong",[t._v("十四、LVM 的缩减操作")])]),t._v(" "),r("p",[t._v("缩减操作需要离线处理。")]),t._v(" "),r("p",[r("strong",[t._v("14.1 LV 的缩减")])]),t._v(" "),r("p",[t._v("A. umount 文件系统")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://images0.cnblogs.com/blog/370046/201406/171414158174790.jpg",target:"_blank",rel:"noopener noreferrer"}},[r("img",{attrs:{src:"https://images0.cnblogs.com/blog/370046/201406/171414163955133.jpg",alt:""}}),r("OutboundLink")],1)]),t._v(" "),r("p",[t._v("B. 缩减文件系统")]),t._v(" "),r("h1",{attrs:{id:"resize2fs-dev-vg0-lv1-4g"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#resize2fs-dev-vg0-lv1-4g"}},[t._v("#")]),t._v(" resize2fs /dev/vg0/lv1 4G")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://images0.cnblogs.com/blog/370046/201406/171414169261463.jpg",target:"_blank",rel:"noopener noreferrer"}},[r("img",{attrs:{src:"https://images0.cnblogs.com/blog/370046/201406/171414174268548.jpg",alt:""}}),r("OutboundLink")],1)]),t._v(" "),r("p",[t._v("提示需要先运行磁盘检查。")]),t._v(" "),r("p",[t._v("C. 检查磁盘")]),t._v(" "),r("h1",{attrs:{id:"e2fsck-f-dev-vg0-lv1"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#e2fsck-f-dev-vg0-lv1"}},[t._v("#")]),t._v(" e2fsck –f /dev/vg0/lv1")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://images0.cnblogs.com/blog/370046/201406/171414180362434.jpg",target:"_blank",rel:"noopener noreferrer"}},[r("img",{attrs:{src:"https://images0.cnblogs.com/blog/370046/201406/171414187233278.jpg",alt:""}}),r("OutboundLink")],1)]),t._v(" "),r("p",[t._v("D. 再次执行缩减操作")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://images0.cnblogs.com/blog/370046/201406/171414195208921.jpg",target:"_blank",rel:"noopener noreferrer"}},[r("img",{attrs:{src:"https://images0.cnblogs.com/blog/370046/201406/171414200207007.jpg",alt:""}}),r("OutboundLink")],1)]),t._v(" "),r("p",[t._v("缩减文件系统成功，下面缩减 LV 的大小。")]),t._v(" "),r("p",[t._v("E. 缩减 LV")]),t._v(" "),r("h1",{attrs:{id:"lvreduce-dev-vg0-lv1-l-4g"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#lvreduce-dev-vg0-lv1-l-4g"}},[t._v("#")]),t._v(" lvreduce /dev/vg0/lv1 –L 4G")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://images0.cnblogs.com/blog/370046/201406/171414206144122.jpg",target:"_blank",rel:"noopener noreferrer"}},[r("img",{attrs:{src:"https://images0.cnblogs.com/blog/370046/201406/171414212863494.jpg",alt:""}}),r("OutboundLink")],1)]),t._v(" "),r("p",[t._v('说明：Step E 和 Step D 缩减的大小必须保持一致，这里的 4G 是缩减到的大小；如果使用的是 "-4G"，则表示容量减少多少的意思。')]),t._v(" "),r("p",[t._v("F. 挂载查看")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://images0.cnblogs.com/blog/370046/201406/171414220208351.jpg",target:"_blank",rel:"noopener noreferrer"}},[r("img",{attrs:{src:"https://images0.cnblogs.com/blog/370046/201406/171414225988695.jpg",alt:""}}),r("OutboundLink")],1)]),t._v(" "),r("p",[t._v("LV 缩减成功。")]),t._v(" "),r("p",[t._v("G. 查看测试数据")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://images0.cnblogs.com/blog/370046/201406/171414231769038.jpg",target:"_blank",rel:"noopener noreferrer"}},[r("img",{attrs:{src:"https://images0.cnblogs.com/blog/370046/201406/171414238326938.jpg",alt:""}}),r("OutboundLink")],1)]),t._v(" "),r("p",[t._v("数据正常。")]),t._v(" "),r("p",[r("strong",[t._v("14.2 VG 的缩减")])]),t._v(" "),r("p",[t._v("A. umount 文件系统")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://images0.cnblogs.com/blog/370046/201406/171414243486496.jpg",target:"_blank",rel:"noopener noreferrer"}},[r("img",{attrs:{src:"https://images0.cnblogs.com/blog/370046/201406/171414247702325.jpg",alt:""}}),r("OutboundLink")],1)]),t._v(" "),r("p",[t._v("B. 查看当前的 PV 详情")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://images0.cnblogs.com/blog/370046/201406/171414253321197.jpg",target:"_blank",rel:"noopener noreferrer"}},[r("img",{attrs:{src:"https://images0.cnblogs.com/blog/370046/201406/171414258489754.jpg",alt:""}}),r("OutboundLink")],1)]),t._v(" "),r("p",[t._v("C. 将 / dev/sdg 从 vg0 中移除")]),t._v(" "),r("h1",{attrs:{id:"vgreduce-vg0-dev-sdg"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#vgreduce-vg0-dev-sdg"}},[t._v("#")]),t._v(" vgreduce vg0 /dev/sdg")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://images0.cnblogs.com/blog/370046/201406/171414263644612.jpg",target:"_blank",rel:"noopener noreferrer"}},[r("img",{attrs:{src:"https://images0.cnblogs.com/blog/370046/201406/171414268177683.jpg",alt:""}}),r("OutboundLink")],1)]),t._v(" "),r("p",[t._v("D. 再次查看 PV 情况")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://images0.cnblogs.com/blog/370046/201406/171414273322541.jpg",target:"_blank",rel:"noopener noreferrer"}},[r("img",{attrs:{src:"https://images0.cnblogs.com/blog/370046/201406/171414279421128.jpg",alt:""}}),r("OutboundLink")],1)]),t._v(" "),r("p",[t._v("/dev/sdg 已经不属于 vg0 了。")]),t._v(" "),r("p",[t._v("E. 查看 vg0 的情况")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://images0.cnblogs.com/blog/370046/201406/171414284893228.jpg",target:"_blank",rel:"noopener noreferrer"}},[r("img",{attrs:{src:"https://images0.cnblogs.com/blog/370046/201406/171414289118056.jpg",alt:""}}),r("OutboundLink")],1)]),t._v(" "),r("p",[t._v("vg0 的大小减少了 5GB.")]),t._v(" "),r("p",[t._v("VG 缩减成功。")]),t._v(" "),r("p",[r("strong",[t._v("十五、删除 LVM")])]),t._v(" "),r("p",[t._v("如果要彻底的来移除 LVM 的话，需要把创建的步骤反过来操作。")]),t._v(" "),r("p",[t._v("15.1 umount 文件系统")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://images0.cnblogs.com/blog/370046/201406/171414294267615.jpg",target:"_blank",rel:"noopener noreferrer"}},[r("img",{attrs:{src:"https://images0.cnblogs.com/blog/370046/201406/171414297866957.jpg",alt:""}}),r("OutboundLink")],1)]),t._v(" "),r("p",[t._v("15.2 移除 LV")]),t._v(" "),r("h1",{attrs:{id:"lvremove-dev-vg0-lv1"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#lvremove-dev-vg0-lv1"}},[t._v("#")]),t._v(" lvremove /dev/vg0/lv1")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://images0.cnblogs.com/blog/370046/201406/171414302865043.jpg",target:"_blank",rel:"noopener noreferrer"}},[r("img",{attrs:{src:"https://images0.cnblogs.com/blog/370046/201406/171414308488615.jpg",alt:""}}),r("OutboundLink")],1)]),t._v(" "),r("p",[t._v("15.3 移除 VG")]),t._v(" "),r("h1",{attrs:{id:"vgremove-vg0"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#vgremove-vg0"}},[t._v("#")]),t._v(" vgremove vg0")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://images0.cnblogs.com/blog/370046/201406/171414314268959.jpg",target:"_blank",rel:"noopener noreferrer"}},[r("img",{attrs:{src:"https://images0.cnblogs.com/blog/370046/201406/171414320514317.jpg",alt:""}}),r("OutboundLink")],1)]),t._v(" "),r("p",[t._v("15.4 移除 PV")]),t._v(" "),r("h1",{attrs:{id:"pvremove-dev-md5-dev-sdf1-dev-sdg-dev-sdh"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#pvremove-dev-md5-dev-sdf1-dev-sdg-dev-sdh"}},[t._v("#")]),t._v(" pvremove /dev/md5 /dev/sdf1 /dev/sdg /dev/sdh")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://images0.cnblogs.com/blog/370046/201406/171414326617202.jpg",target:"_blank",rel:"noopener noreferrer"}},[r("img",{attrs:{src:"https://images0.cnblogs.com/blog/370046/201406/171414334573845.jpg",alt:""}}),r("OutboundLink")],1)]),t._v(" "),r("p",[t._v("LVM 移除成功。")]),t._v(" "),r("p",[r("strong",[t._v("十六、LVM 快照（snapshot）")])]),t._v(" "),r("p",[t._v("快照就是将当时的系统信息记录下来，就好像照相一样，未来若有任何资料变动了，则"),r("strong",[t._v("原始资料会被移动到快照区，没有被改动的区域则由快照区与档案系统共享")]),t._v("。")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://images0.cnblogs.com/blog/370046/201406/171414339733404.gif",target:"_blank",rel:"noopener noreferrer"}},[r("img",{attrs:{src:"https://images0.cnblogs.com/blog/370046/201406/171414345513747.gif",alt:""}}),r("OutboundLink")],1)]),t._v(" "),r("p",[t._v("LVM 系统快照区域的备份示意图 (虚线为档案系统，长虚线为快照区)")]),t._v(" "),r("p",[t._v("左图为最初建立系统快照区的状况，LVM 会预留一个区域 (左图的左侧三个 PE 区块) 作为数据存放处。此时快照区内并没有任何数据，而快照区与系统区共享所有的 PE 数据， 因此你会看到快照区的内容与文件系统是一模一样的。等到系统运作一阵子后，假设 A 区域的数据被更动了 (上面右图所示)，则更动前系统会将该区域的数据移动到快照区，所以在右图的快照区被占用了一块 PE 成为 A，而其他 B 到 I 的区块则还是与文件系统共享！")]),t._v(" "),r("p",[t._v("快照区与被快照的 LV 必须要在同一个 VG 里。")]),t._v(" "),r("p",[t._v("16.1 建立 LV")]),t._v(" "),r("h1",{attrs:{id:"lvcreate-l-100m-n-lv1-vg0"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#lvcreate-l-100m-n-lv1-vg0"}},[t._v("#")]),t._v(" lvcreate -L 100M -n lv1 vg0")]),t._v(" "),r("h1",{attrs:{id:"mkfs-ext4-dev-vg0-lv1-2"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#mkfs-ext4-dev-vg0-lv1-2"}},[t._v("#")]),t._v(" mkfs.ext4 /dev/vg0/lv1")]),t._v(" "),r("h1",{attrs:{id:"mount-dev-vg0-lv1-mnt-lv1-2"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#mount-dev-vg0-lv1-mnt-lv1-2"}},[t._v("#")]),t._v(" mount /dev/vg0/lv1 /mnt/lv1/")]),t._v(" "),r("p",[t._v("16.2 写入测试数据")]),t._v(" "),r("h1",{attrs:{id:"touch-mnt-lv1-test-lvm-snapshot-1"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#touch-mnt-lv1-test-lvm-snapshot-1"}},[t._v("#")]),t._v(" touch /mnt/lv1/test_lvm_snapshot_1")]),t._v(" "),r("h1",{attrs:{id:"touch-mnt-lv1-test-lvm-snapshot-2"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#touch-mnt-lv1-test-lvm-snapshot-2"}},[t._v("#")]),t._v(" touch /mnt/lv1/test_lvm_snapshot_2")]),t._v(" "),r("h1",{attrs:{id:"cp-a-etc-mnt-lv1"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#cp-a-etc-mnt-lv1"}},[t._v("#")]),t._v(" cp -a /etc/ /mnt/lv1/")]),t._v(" "),r("h1",{attrs:{id:"cp-a-boot-mnt-lv1"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#cp-a-boot-mnt-lv1"}},[t._v("#")]),t._v(" cp -a /boot/ /mnt/lv1/")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://images0.cnblogs.com/blog/370046/201406/171414352541363.jpg",target:"_blank",rel:"noopener noreferrer"}},[r("img",{attrs:{src:"https://images0.cnblogs.com/blog/370046/201406/171414359118261.jpg",alt:""}}),r("OutboundLink")],1)]),t._v(" "),r("p",[t._v("16.3 创建快照")]),t._v(" "),r("h1",{attrs:{id:"lvcreate-l-80m-s-n-lv1snap-dev-vg0-lv1"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#lvcreate-l-80m-s-n-lv1snap-dev-vg0-lv1"}},[t._v("#")]),t._v(" lvcreate -L 80M -s -n lv1snap /dev/vg0/lv1")]),t._v(" "),r("p",[t._v("说明：为 / dev/vg0/lv1 创建一个大小为 80M，名称为 lv1snap 的快照。")]),t._v(" "),r("h1",{attrs:{id:"lvdisplay-2"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#lvdisplay-2"}},[t._v("#")]),t._v(" lvdisplay")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://images0.cnblogs.com/blog/370046/201406/171414368018634.jpg",target:"_blank",rel:"noopener noreferrer"}},[r("img",{attrs:{src:"https://images0.cnblogs.com/blog/370046/201406/171414376459291.jpg",alt:""}}),r("OutboundLink")],1)]),t._v(" "),r("p",[t._v("/dev/vg0/lv1snap 的 LV Size 为 100MB，使用量为 0.01%.")]),t._v(" "),r("p",[t._v("16.4 将刚才创建的快照挂载查看")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://images0.cnblogs.com/blog/370046/201406/171414384117691.jpg",target:"_blank",rel:"noopener noreferrer"}},[r("img",{attrs:{src:"https://images0.cnblogs.com/blog/370046/201406/171414390671293.jpg",alt:""}}),r("OutboundLink")],1)]),t._v(" "),r("p",[t._v("/mnt/lv1 和 / mnt/snapshot 是一模一样的。")]),t._v(" "),r("p",[t._v("16.5 进行档案的修改操作")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://images0.cnblogs.com/blog/370046/201406/171414398172922.jpg",target:"_blank",rel:"noopener noreferrer"}},[r("img",{attrs:{src:"https://images0.cnblogs.com/blog/370046/201406/171414406148565.jpg",alt:""}}),r("OutboundLink")],1)]),t._v(" "),r("p",[t._v("16.6 再次查看")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://images0.cnblogs.com/blog/370046/201406/171414415826494.jpg",target:"_blank",rel:"noopener noreferrer"}},[r("img",{attrs:{src:"https://images0.cnblogs.com/blog/370046/201406/171414423328123.jpg",alt:""}}),r("OutboundLink")],1)]),t._v(" "),r("p",[t._v("snapshot 的使用量为 10.36%，原始资料有改动。")]),t._v(" "),r("p",[t._v("16.7 对 snapshot 里的资料进行打包备份，准备还原")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://images0.cnblogs.com/blog/370046/201406/171414429573481.jpg",target:"_blank",rel:"noopener noreferrer"}},[r("img",{attrs:{src:"https://images0.cnblogs.com/blog/370046/201406/171414434898810.jpg",alt:""}}),r("OutboundLink")],1)]),t._v(" "),r("p",[t._v("16.8 卸载并移除 snapshot")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://images0.cnblogs.com/blog/370046/201406/171414440825924.jpg",target:"_blank",rel:"noopener noreferrer"}},[r("img",{attrs:{src:"https://images0.cnblogs.com/blog/370046/201406/171414449893069.jpg",alt:""}}),r("OutboundLink")],1)]),t._v(" "),r("p",[t._v("16.9 卸载并格式化 / mnt/lv1，清空数据")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://images0.cnblogs.com/blog/370046/201406/171414457702941.jpg",target:"_blank",rel:"noopener noreferrer"}},[r("img",{attrs:{src:"https://images0.cnblogs.com/blog/370046/201406/171414466295071.jpg",alt:""}}),r("OutboundLink")],1)]),t._v(" "),r("p",[t._v("16.10 恢复数据")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://images0.cnblogs.com/blog/370046/201406/171414472397955.jpg",target:"_blank",rel:"noopener noreferrer"}},[r("img",{attrs:{src:"https://images0.cnblogs.com/blog/370046/201406/171414479117327.jpg",alt:""}}),r("OutboundLink")],1)]),t._v(" "),r("p",[t._v("可以看到，原始数据已经成功恢复。")]),t._v(" "),r("p",[t._v("LVM 快照实验成功。")]),t._v(" "),r("p",[t._v("**注意：**对 lv1 的修改量不能超过快照的大小，由于原始数据会被搬移到快照区，如果你的快照区不够大，若原始资料被更动的实际数据量比快照区大，那么快照区当然容纳不了，这时候快照功能会失效喔！")]),t._v(" "),r("p",[r("strong",[t._v("参考资料")])]),t._v(" "),r("ul",[r("li",[t._v("鸟哥的 Linux 私房菜：http://linux.vbird.org/linux_basic/0420quota.php#lvm")]),t._v(" "),r("li",[t._v("羽飞博客：http://www.opsers.org/base/one-day-a-little-learning-linux-logical-volume-manager-lvm-on-the-rhel6.html")])]),t._v(" "),r("p",[r("strong",[t._v("CentOS 6.3 下配置软 RAID（Software RAID）")])]),t._v(" "),r("p",[r("a",{attrs:{href:"http://www.cnblogs.com/mchina/p/linux-centos-disk-array-software_raid.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://www.cnblogs.com/mchina/p/linux-centos-disk-array-software_raid.html"),r("OutboundLink")],1)]),t._v(" "),r("hr"),t._v(" "),r("p",[r("strong",[t._v("David Camp")])]),t._v(" "),r("ul",[r("li",[t._v("技术交流，请加 QQ 群：")])]),t._v(" "),r("p",[t._v("系统运维技术分享 Ⅲ：416491168")]),t._v(" "),r("ul",[r("li",[t._v("业务合作，请联系作者 QQ：562866602")]),t._v(" "),r("li",[t._v("我的微信号：mchina_tang")]),t._v(" "),r("li",[t._v("给我写信：mchina_tang@qq.com")]),t._v(" "),r("li",[t._v("我的地址：江苏 · 苏州")])]),t._v(" "),r("p",[t._v("******我们永远相信，分享是一种美德 | **"),r("strong",[t._v("We Believe, Great People Share Knowledge...")])])])}),[],!1,null,null,null);e.default=a.exports}}]);