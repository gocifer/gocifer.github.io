(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{431:function(s,a,t){"use strict";t.r(a);var e=t(6),n=Object(e.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"磁盘管理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#磁盘管理"}},[s._v("#")]),s._v(" 磁盘管理")]),s._v(" "),t("p",[s._v("[toc]")]),s._v(" "),t("h1",{attrs:{id:"磁盘管理-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#磁盘管理-2"}},[s._v("#")]),s._v(" 磁盘管理")]),s._v(" "),t("h2",{attrs:{id:"查看信息"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查看信息"}},[s._v("#")]),s._v(" 查看信息")]),s._v(" "),t("h3",{attrs:{id:"du：统计文件和目录占用的磁盘空间。"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#du：统计文件和目录占用的磁盘空间。"}},[s._v("#")]),s._v(" du：统计文件和目录占用的磁盘空间。")]),s._v(" "),t("p",[t("strong",[s._v("语法：du [-ahskm] 文件或目录名称")])]),s._v(" "),t("p",[s._v("Linux du命令也是查看使用空间的，但是与df命令不同的是Linux du命令是对文件和目录磁盘使用的空间的查看，还是和df命令有一些区别的")]),s._v(" "),t("ul",[t("li",[s._v("如果没有指定文件或目录名，则默认对当前"),t("strong",[s._v("目录")]),s._v("进行统计。")]),s._v(" "),t("li",[s._v("-S仅显示文件或目录占用的块数，默认一块等于1024字节,显示每个各别的目录占用容量")]),s._v(" "),t("li",[s._v("-s ：不包括子目录下的总计，与 -S 有点差别")]),s._v(" "),t("li",[s._v("-b ：以字节为单位进行统计；-k以1024字节为单位；-m以1024K为单位")]),s._v(" "),t("li",[s._v("-c ：显示子文件夹，同时显示总计；")]),s._v(" "),t("li",[s._v("-a ：显示所有"),t("strong",[s._v("文件")]),s._v("及其子目录占用的数据块数,因为默认仅统计目录。")]),s._v(" "),t("li",[s._v("-h ：以人们较易读的容量格式 (K/G/M) 显示")]),s._v(" "),t("li",[s._v("-H ：以1000为换算单位")])]),s._v(" "),t("p",[s._v("例：\n"),t("code",[s._v("du -tommy，统计tommy的主目录")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("[root@www ~]# du\n      ./test4     <==每个目录都会列出来\n      ./test2\n....中间省略....\n     ./.gconfd   <==包括隐藏文件的目录\n    .           <==这个目录(.)所占用的总量\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("NO1. 查看当前文件夹大小\n[root@rehat root]# du -sh\n\n\nNO2. 查看当前文件及文件中包含的子文件夹大小\n[root@rehat root]# du -ch\n\n\n\nNO3. 同时查看多个文件的大小\n[root@rehat root]# du -h test1.txt test2.txt\n\n \nNo4. 按序查看文件夹下子文件的大小\ncd /yourpath 查看该目录中各文件夹大小\ndu -sk * | sort -n\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br")])]),t("h3",{attrs:{id:"df：显示文件系统磁盘空间使用情况"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#df：显示文件系统磁盘空间使用情况"}},[s._v("#")]),s._v(" df：显示文件系统磁盘空间使用情况")]),s._v(" "),t("p",[t("strong",[s._v("df [-ahikHTm] [目录或文件名]")])]),s._v(" "),t("p",[s._v("不指定文件系统的话，则显示所有当前挂载的文件系统的可用空间。")]),s._v(" "),t("p",[s._v("默认情况下 空间以1KB为单位进行显示，除非环境变量POSIXLY_CORRECT被指定，\n此时以512字节为单位。")]),s._v(" "),t("ul",[t("li",[s._v("-a ：列出所有的文件系统，包括系统特有的 /proc 等文件系统；")]),s._v(" "),t("li",[s._v("-k ：以 KBytes 的容量显示各文件系统；")]),s._v(" "),t("li",[s._v("-m ：以 MBytes 的容量显示各文件系统；")]),s._v(" "),t("li",[s._v("-h ：以人们较易阅读的 GBytes, MBytes, KBytes 等格式自行显示；")]),s._v(" "),t("li",[s._v("-H ：以1000为换算单位")]),s._v(" "),t("li",[s._v("-T ：显示文件系统类型, 连同该 partition 的 filesystem 名称 (例如 ext3) 也列出；")]),s._v(" "),t("li",[s._v("-i ：不用硬盘容量，而以 inode 的数量来显示")]),s._v(" "),t("li",[s._v("-t type只显示指定文件系统的信息，如df -t ext3；")]),s._v(" "),t("li",[s._v("-x type与-t相反，不显示指定的磁盘类型的磁盘。）")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("NO1. 显示所有存储系统空间使用情况,同时显示存储系统的文件系统类型s\n[root@rehat root]# df -aT\n\n\nNO2. 显示指定文件系统的空间使用情况\n[root@rehat root]# df -t ext3\n\n\nNO3. 人性化显示各存储空间大小\n[root@rehat root]# df -ah\n\n\nNO4. 有时候挂载了网络文件系统，若只想看本机的文件系统用如下命令\n[root@rehat root]# df -ahlT\n\n\nNO5. 查看某个文件系统的磁盘使用情况\n[root@rehat root]# df -h /dev/cdrom\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br")])]),t("h3",{attrs:{id:"stat-显示文件-目录或文件系统的大小和其他统计信息。"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#stat-显示文件-目录或文件系统的大小和其他统计信息。"}},[s._v("#")]),s._v(" stat:显示文件/目录或文件系统的大小和其他统计信息。")]),s._v(" "),t("p",[s._v("stat <文件/目录>")]),s._v(" "),t("h2",{attrs:{id:"磁盘挂载-卸载"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#磁盘挂载-卸载"}},[s._v("#")]),s._v(" 磁盘挂载/卸载")]),s._v(" "),t("h3",{attrs:{id:"磁盘挂载使用-mount-命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#磁盘挂载使用-mount-命令"}},[s._v("#")]),s._v(" 磁盘挂载使用 mount 命令")]),s._v(" "),t("p",[s._v("语法："),t("strong",[s._v("mount [-t 文件系统] [-L Label名] [-o 额外选项] [-n]  装置文件名  挂载点")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("用默认的方式，将刚刚创建的 /dev/hdc6 挂载到 /mnt/hdc6 上面！\n\n复制代码\n[root@www ~]# mkdir /mnt/hdc6\n[root@www ~]# mount /dev/hdc6 /mnt/hdc6\n[root@www ~]# df\nFilesystem           1K-blocks      Used Available Use% Mounted on\n.....中间省略.....\n/dev/hdc6              1976312     42072   1833836   3% /mnt/hdc6\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("h3",{attrs:{id:"卸载使用-umount-命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#卸载使用-umount-命令"}},[s._v("#")]),s._v(" 卸载使用 umount 命令")]),s._v(" "),t("p",[s._v("语法："),t("strong",[s._v("umount [-fn] 装置文件名或挂载点")])]),s._v(" "),t("p",[s._v("选项与参数：")]),s._v(" "),t("p",[s._v("-f ：强制卸除！可用在类似网络文件系统 (NFS) 无法读取到的情况下；\n-n ：不升级 /etc/mtab 情况下卸除。")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("卸载/dev/hdc6\n[root@www ~]# umount /dev/hdc6  \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h3",{attrs:{id:"busy-device"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#busy-device"}},[s._v("#")]),s._v(" busy device")]),s._v(" "),t("blockquote",[t("p",[s._v("在下载一个go程序时，遇到这样的问题：Invalid cross-device link error with boost filesystem，主要是下载一个额外的文件时是下载在/tmp分区，然后调用OS的rename()函数来建立硬链接，然而/tmp往往实际是使用的swap分区，而和用户分区不在同一个硬盘分区，硬链接是无法跨磁盘操作的")])]),s._v(" "),t("p",[s._v("因此需要先解挂载/tmp，然后在用户分区新建/tmp或者使用软链接。")]),s._v(" "),t("p",[s._v("/tmp是一个实时读写的文件夹，mount的强制解挂载可能不会生效")]),s._v(" "),t("h4",{attrs:{id:"强制解挂载"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#强制解挂载"}},[s._v("#")]),s._v(" 强制解挂载")]),s._v(" "),t("p",[s._v("umount -f/--force")]),s._v(" "),t("h4",{attrs:{id:"杀死使用进程随后解挂载"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#杀死使用进程随后解挂载"}},[s._v("#")]),s._v(" 杀死使用进程随后解挂载")]),s._v(" "),t("blockquote",[t("p",[s._v("If the reason is that processes are using the filesystem, we can kill the processes using the filesystem and then it will be fine to unmount it. Here, we introduce 2 common methods with 2 common tools.")])]),s._v(" "),t("ul",[t("li",[t("p",[s._v("Method 1: use lsof ∞：")]),s._v(" "),t("ul",[t("li",[s._v("The following command finds out the processes accessing the partition/filesystem. You need to run the following command as root. Here, we use the mount point /tmp as an example.")]),s._v(" "),t("li",[t("code",[s._v("# lsof | grep '/tmp'")])])])]),s._v(" "),t("li",[t("p",[s._v("Method 2: use fuser ∞")]),s._v(" "),t("ul",[t("li",[s._v("You can find out the processes using a filesystem (e.g. /mnt/data) by:")]),s._v(" "),t("li",[t("code",[s._v("# fuser /mnt/data")])]),s._v(" "),t("li",[s._v("fuser can also help you kill all processes using a filesystem at the same time by:")]),s._v(" "),t("li",[t("code",[s._v("# fuser -k /mnt/data")]),s._v(" or "),t("code",[s._v("# fuser -k -9 /mnt/data")])]),s._v(" "),t("li",[s._v("Then you can continue to umount the filesystem.")])])])]),s._v(" "),t("h2",{attrs:{id:"磁盘分区"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#磁盘分区"}},[s._v("#")]),s._v(" 磁盘分区")]),s._v(" "),t("p",[s._v("硬盘可以分成若干个分区，每个分区可视为独立的磁盘来使用。硬盘的分区方案被记录到“磁盘分区表”中，通常该表由4个部分组成，每个部分定义一个分区的信息，因此原始概念中一个硬盘最多只能建立4个分区，称为“主分区”。")]),s._v(" "),t("p",[s._v("由于硬盘越来越大，4个分区已不无法满足用户的需要，为此引入“扩展分区”的概念。扩 展分区由扩展磁盘分区表维护，可以把某个主分区作为扩展分区划分为若干更小的“逻辑分区”。理论上，硬盘空间足够时，可以建立任意数量的分区。")]),s._v(" "),t("p",[s._v("Linux上建议的分区有：swap分区，即虚拟内存；boot分区，存放操作系统的内核；根分区，整个操作系统的根目录；/var分区，可以避免日志文件的大小失控；/home分区，控制用户占用的空间大小。")]),s._v(" "),t("h2",{attrs:{id:"linux磁盘分区工具"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#linux磁盘分区工具"}},[s._v("#")]),s._v(" linux磁盘分区工具")]),s._v(" "),t("h3",{attrs:{id:"fdisk-linux-的磁盘分区表操作工具。"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#fdisk-linux-的磁盘分区表操作工具。"}},[s._v("#")]),s._v(" fdisk:Linux 的磁盘分区表操作工具。")]),s._v(" "),t("p",[s._v("强大的磁盘分区工具，不仅适合于Linux，在 Windows及MS-DOS中也有广泛应用。")]),s._v(" "),t("ul",[t("li",[s._v("-l显示当前设备的分区表。")]),s._v(" "),t("li",[s._v("-s /dev/sda1显示指定分区的大小。")]),s._v(" "),t("li",[s._v("-s /dev/sda显示设备所有分区大小的总和。")]),s._v(" "),t("li",[s._v("-v显示fdisk的版本号。")]),s._v(" "),t("li",[s._v("fdisk /dev/sda可以进入命令交互模式，内部命令包括m：显示命令帮助；p：显示当前分区表；q：退出；")])]),s._v(" "),t("blockquote",[t("p",[s._v("注：离开 fdisk 时按下 q，那么所有的动作都不会生效！相反的， 按下w就是动作生效的意思。")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("Command (m for help): m   <== 输入 m 后，就会看到底下这些命令介绍\nCommand action\n   a   toggle a bootable flag\n   b   edit bsd disklabel\n   c   toggle the dos compatibility flag\n   d   delete a partition            <==删除一个partition\n   l   list known partition types\n   m   print this menu\n   n   add a new partition           <==新增一个partition\n   o   create a new empty DOS partition table\n   p   print the partition table     <==在屏幕上显示分割表\n   q   quit without saving changes   <==不储存离开fdisk程序\n   s   create a new empty Sun disklabel\n   t   change a partition's system id\n   u   change display/entry units\n   v   verify the partition table\n   w   write table to disk and exit  <==将刚刚的动作写入分割表\n   x   extra functionality (experts only)\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br")])]),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("Command (m for help): p  <== 这里可以输出目前磁盘的状态\n\nDisk /dev/hdc: 41.1 GB, 41174138880 bytes        <==这个磁盘的文件名与容量\nheads, 63 sectors/track, 5005 cylinders      <==磁头、扇区与磁柱大小\nUnits = cylinders of 16065 * 512 = 8225280 bytes <==每个磁柱的大小\n\n   Device Boot      Start         End      Blocks   Id  System\n/dev/hdc1   *           1          13      104391   83  Linux\n/dev/hdc2              14        1288    10241437+  83  Linux\n/dev/hdc3            1289        1925     5116702+  83  Linux\n/dev/hdc4            1926        5005    24740100    5  Extended\n/dev/hdc5            1926        2052     1020096   82  Linux swap / Solaris\n# 装置文件名 启动区否 开始磁柱    结束磁柱  1K大小容量 磁盘分区槽内的系统\n\nCommand (m for help): q\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br")])]),t("h3",{attrs:{id:"mkfs：设置磁盘的文件系统"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mkfs：设置磁盘的文件系统"}},[s._v("#")]),s._v(" mkfs：设置磁盘的文件系统")]),s._v(" "),t("p",[s._v("mkfs [-t 文件系统格式] 装置文件名")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("mkfs -t ext4 /dev/sda2\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("[root@www ~]# mkfs -t ext3 /dev/hdc6\nmke2fs 1.39 (29-May-2006)\nFilesystem label=                <==这里指的是分割槽的名称(label)\nOS type: Linux\nBlock size=4096 (log=2)          <==block 的大小配置为 4K \nFragment size=4096 (log=2)\ninodes, 502023 blocks     <==由此配置决定的inode/block数量\nblocks (5.00%) reserved for the super user\nFirst data block=0\nMaximum filesystem blocks=515899392\nblock groups\nblocks per group, 32768 fragments per group\ninodes per group\nSuperblock backups stored on blocks:\n        32768, 98304, 163840, 229376, 294912\n\nWriting inode tables: done\nCreating journal (8192 blocks): done <==有日志记录\nWriting superblocks and filesystem accounting information: done\n\nThis filesystem will be automatically checked every 34 mounts or\ndays, whichever comes first.  Use tune2fs -c or -i to override.\n# 这样就创建起来我们所需要的 Ext3 文件系统了！简单明了！\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br")])]),t("h3",{attrs:{id:"parted"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#parted"}},[s._v("#")]),s._v(" parted")]),s._v(" "),t("p",[s._v("Linux下的磁盘分区与分区调整工具。parted /dev/sda可进入交互模式。")]),s._v(" "),t("p",[s._v("sfdisk：-l显示分区信息。-s显示磁盘或分区大小。")]),s._v(" "),t("h2",{attrs:{id:"检验"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#检验"}},[s._v("#")]),s._v(" 检验")]),s._v(" "),t("h3",{attrs:{id:"fsck（file-system-check）"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#fsck（file-system-check）"}},[s._v("#")]),s._v(" fsck（file system check）")]),s._v(" "),t("p",[s._v("用来检查和维护不一致的文件系统。")]),s._v(" "),t("p",[s._v("若系统掉电或磁盘发生问题，可利用fsck命令对文件系统进行检查。")]),s._v(" "),t("p",[s._v("语法："),t("strong",[s._v("fsck [-t 文件系统] [-ACay] 装置名称")])]),s._v(" "),t("p",[s._v("选项与参数：")]),s._v(" "),t("ul",[t("li",[s._v("-t : 给定档案系统的型式，若在 /etc/fstab 中已有定义或 kernel 本身已支援的则不需加上此参数")]),s._v(" "),t("li",[s._v("-s : 依序一个一个地执行 fsck 的指令来检查")]),s._v(" "),t("li",[s._v("-A : 对/etc/fstab 中所有列出来的 分区（partition）做检查")]),s._v(" "),t("li",[s._v("-C : 显示完整的检查进度")]),s._v(" "),t("li",[s._v("-d : 打印出 e2fsck 的 debug 结果")]),s._v(" "),t("li",[s._v("-p : 同时有 -A 条件时，同时有多个 fsck 的检查一起执行")]),s._v(" "),t("li",[s._v("-R : 同时有 -A 条件时，省略 / 不检查")]),s._v(" "),t("li",[s._v("-V : 详细显示模式")]),s._v(" "),t("li",[s._v("-a : 如果检查有错则自动修复")]),s._v(" "),t("li",[s._v("-r : 如果检查有错则由使用者回答是否修复")]),s._v(" "),t("li",[s._v("-y : 选项指定检测每个文件时自动输入yes，在不确定那些是不正常的时候，可以执行 # fsck -y 全部检查修复。")])]),s._v(" "),t("p",[s._v("实例 1")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("查看系统有多少文件系统支持的 fsck 命令：\n\n[root@www ~]# fsck[tab][tab]\nfsck         fsck.cramfs  fsck.ext2    fsck.ext3    fsck.msdos   fsck.vfat\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("强制检测 /dev/hdc6 分区:\n\n[root@www ~]# fsck -C -f -t ext3 /dev/hdc6 \nfsck 1.39 (29-May-2006)\ne2fsck 1.39 (29-May-2006)\nPass 1: Checking inodes, blocks, and sizes\nPass 2: Checking directory structure\nPass 3: Checking directory connectivity\nPass 4: Checking reference counts\nPass 5: Checking group summary information\nvbird_logical: 11/251968 files (9.1% non-contiguous), 36926/1004046 blocks\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("h3",{attrs:{id:"badblocks：检查设备坏块。"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#badblocks：检查设备坏块。"}},[s._v("#")]),s._v(" badblocks：检查设备坏块。")]),s._v(" "),t("p",[s._v("（-s 显示检查进度。）")]),s._v(" "),t("h3",{attrs:{id:"fdformat：格式化磁盘"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#fdformat：格式化磁盘"}},[s._v("#")]),s._v(" fdformat：格式化磁盘")]),s._v(" "),t("p",[s._v("-n表示格式化完成后不进行验证。")]),s._v(" "),t("h3",{attrs:{id:"hdparam：显示和设定硬盘参数。"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#hdparam：显示和设定硬盘参数。"}},[s._v("#")]),s._v(" hdparam：显示和设定硬盘参数。")]),s._v(" "),t("p",[s._v("（-C显示电源管理，-d 1开启DMA模式。例：hdparm /dev/sda1。）")]),s._v(" "),t("h3",{attrs:{id:"mkswap：设置交换分区（swap-area）"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mkswap：设置交换分区（swap-area）"}},[s._v("#")]),s._v(" mkswap：设置交换分区（swap area）")]),s._v(" "),t("p",[s._v("例：mkswap /dev/hda4，将hda4指定为一个新式的交换分区。")]),s._v(" "),t("ul",[t("li",[s._v("-c在创建交换分区前检查坏块；")]),s._v(" "),t("li",[s._v("-v0建立一个旧式的交换区;")]),s._v(" "),t("li",[s._v("-v1建立一个新式的交换区。）")])]),s._v(" "),t("h3",{attrs:{id:"mkisofs：建立iso9660-joliet-hts文件系统"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mkisofs：建立iso9660-joliet-hts文件系统"}},[s._v("#")]),s._v(" mkisofs：建立ISO9660/JOLIET/HTS文件系统")]),s._v(" "),t("p",[s._v("例：mkisofs -o myiso myfile把myfile制作为名为myiso的镜像文件。")]),s._v(" "),t("h3",{attrs:{id:"mkinitrd：创建ramdisk的镜像文件。"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mkinitrd：创建ramdisk的镜像文件。"}},[s._v("#")]),s._v(" mkinitrd：创建ramdisk的镜像文件。")]),s._v(" "),t("p",[s._v("例：mkinitrd myfile.img 2.2.5-15建立名为myfile.img、内核号为2.2.5-15的镜像文件。ubuntu上不支持。")]),s._v(" "),t("h3",{attrs:{id:"mt：磁带驱动操作。"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mt：磁带驱动操作。"}},[s._v("#")]),s._v(" mt：磁带驱动操作。")]),s._v(" "),t("p",[s._v("语法：mt operation device。操作有rewind、erase等。rmt命令是远端磁带传输协议模块，可以通过进程间通信，远程控制磁带机进行备份、恢复备份操作。")]),s._v(" "),t("h3",{attrs:{id:"mzip：弹出zip-jaz设备中的磁盘"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mzip：弹出zip-jaz设备中的磁盘"}},[s._v("#")]),s._v(" mzip：弹出Zip/Jaz设备中的磁盘")]),s._v(" "),t("p",[s._v("-e弹出磁盘；-f与-e同时使用强制弹出；-q查询状态。")]),s._v(" "),t("h3",{attrs:{id:"sync：将缓冲区内的数据写入磁盘"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#sync：将缓冲区内的数据写入磁盘"}},[s._v("#")]),s._v(" sync：将缓冲区内的数据写入磁盘")]),s._v(" "),t("p",[s._v("在卸载移动硬盘前，可用sync把内存数据写入磁盘。")]),s._v(" "),t("h4",{attrs:{id:"rsync：远程同步"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#rsync：远程同步"}},[s._v("#")]),s._v(" rsync：远程同步")]),s._v(" "),t("p",[s._v("例：")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("rsync -av -e ssh /home/share/*.doc root@teacher.example.com:/usr/local/share\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("通过ssh把/home/share下的所有doc文件备份到了 teacher主机的/usr/local/share目录下。")]),s._v(" "),t("p",[s._v("只同步修改过的文件和目录。-a：归档模式；-v：冗余模式。")]),s._v(" "),t("h2",{attrs:{id:"磁盘配额管理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#磁盘配额管理"}},[s._v("#")]),s._v(" 磁盘配额管理:")]),s._v(" "),t("h3",{attrs:{id:"etc-fstab文件：定义分区的挂载方式。"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#etc-fstab文件：定义分区的挂载方式。"}},[s._v("#")]),s._v(" /etc/fstab文件：定义分区的挂载方式。")]),s._v(" "),t("ul",[t("li",[s._v("文件格式 为：\n"),t("code",[s._v("<file system> <mount point> <type> <options> <dump> <pass>")])])]),s._v(" "),t("p",[s._v("例："),t("code",[s._v("/dev/sda1 / ext4 errors=remount-ro,user_xattr 0")])]),s._v(" "),t("ul",[t("li",[s._v("要启用磁盘配额管理，则需要添加usrquota和grpquota选项，")])]),s._v(" "),t("p",[s._v("例："),t("code",[s._v("/dev/sda2 /mnt/disk ext4 defaults,usrquota,grpquota 0")])]),s._v(" "),t("ul",[t("li",[s._v("更改该文件后，需要reboot或者重新挂载使得配置文件生效")])]),s._v(" "),t("p",[t("code",[s._v("mount -o remount /dev/sda2。")])]),s._v(" "),t("p",[s._v("注意，当新的分区建立后，需要使用mkfs指定该分区的文件类型，否则挂载时会出现找不到文件系统的错误。）")]),s._v(" "),t("h3",{attrs:{id:"quotacheck：检查磁盘的使用空间与限制"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#quotacheck：检查磁盘的使用空间与限制"}},[s._v("#")]),s._v(" quotacheck：检查磁盘的使用空间与限制")]),s._v(" "),t("p",[s._v("在修改/etc /fstab文件并添加usrquota与grpquota选项后，可以使用命令")]),s._v(" "),t("p",[t("code",[s._v("quotacheck -avugc")])]),s._v(" "),t("p",[s._v("来创建aquota.user和aquota.group这两个文件，其中：")]),s._v(" "),t("ul",[t("li",[s._v("-c表示重新创建配额文件")]),s._v(" "),t("li",[s._v("-a扫描在/etc/mtab文件中所 有挂载的非NFS文件系统")]),s._v(" "),t("li",[s._v("-u计算每个用户占用的目录和文件数目，并创建aquota.user文件")]),s._v(" "),t("li",[s._v("-g计算每个用户组占用的目录和文件数目，并创建aquota.group文件")]),s._v(" "),t("li",[s._v("-v显示命令执行过程。")])]),s._v(" "),t("h3",{attrs:{id:"etc-mtab与-etc-fstab内容类似"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#etc-mtab与-etc-fstab内容类似"}},[s._v("#")]),s._v(" /etc/mtab与/etc/fstab内容类似")]),s._v(" "),t("p",[s._v("/etc/fstab表示系统开机时默认加载 的分区")]),s._v(" "),t("p",[s._v("而/etc/mtab表示目前系统加载中的分区。创建出来的aquota.user和aquota.group文件位于启用usrquota和 grpquota选项的分区所挂载的位置，如/mnt/disk。")]),s._v(" "),t("ul",[t("li",[s._v("edquota：对用户或用户组设置磁盘配额。")])]),s._v(" "),t("p",[s._v("aquota.user和aquota.group文件太复杂，无法直接编辑，只能用edquotaa命令编辑。")]),s._v(" "),t("ul",[t("li",[s._v("-u username设置用户的磁盘配额，")]),s._v(" "),t("li",[s._v("-g groupname设置用户组的磁盘配额。")]),s._v(" "),t("li",[s._v("默认情况下-u被使用。文件格式为：Filesystem blocks soft hard inodes soft hard，")]),s._v(" "),t("li",[s._v("其中bolocks为用户已使用的空间，以块为单位，一块为1024字节，相应的inodes为已使用的i结点数。")]),s._v(" "),t("li",[s._v("soft为软限制，当用户达 到此限制时，系统会发出警告信息，但用户仍然可以继续使用；")]),s._v(" "),t("li",[s._v("hard为硬限制，到达此限制时用户就无法写入了。")]),s._v(" "),t("li",[s._v("前面的soft、hard 对应block的 软、硬限制，而后面的soft、hard对应inode的软、硬限制。")]),s._v(" "),t("li",[s._v("-p复制配额设置，如edquota -p usr1 -u usr2 usr3；-t设置软时间限制。）")])]),s._v(" "),t("p",[s._v("quota：显示磁盘已使用的空间与配额限制。（-u查看用户，为默认选项；-g查看用户组。）")]),s._v(" "),t("p",[s._v("quotaoff：关闭磁盘空间限制。（-a关闭所有在/etc/fstab列出的磁盘配额；-g用户组配额；-u用户配额；-p列出状态。）")]),s._v(" "),t("p",[s._v("quotaon：启动磁盘空间配额限制。（语法与quotaoff一样。）")]),s._v(" "),t("p",[s._v("quotastats：显示磁盘空间的限制。")]),s._v(" "),t("p",[s._v("repquota：对文件系统的磁盘配额情况进行统计。")]),s._v(" "),t("h2",{attrs:{id:"逻辑卷管理（lvm）"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#逻辑卷管理（lvm）"}},[s._v("#")]),s._v(" 逻辑卷管理（LVM）")]),s._v(" "),t("h3",{attrs:{id:"lvm中相关的定义"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#lvm中相关的定义"}},[s._v("#")]),s._v(" LVM中相关的定义:")]),s._v(" "),t("p",[s._v("物理卷（Physical volume，PV）相当于硬盘驱动器的一个标准主分区或逻辑分区；")]),s._v(" "),t("p",[s._v("物理盘区（Physical extent，PE）就是一块磁盘空间。物理卷被划分成多个同等大小的PE；")]),s._v(" "),t("p",[s._v("逻辑卷（Logical volume，LV）是LE的集合；")]),s._v(" "),t("p",[s._v("逻辑盘区（Logical extent，PE）和一个PE相对应，大小相同；")]),s._v(" "),t("p",[s._v("卷组（Volumn group，VG）是LV的集合。")]),s._v(" "),t("h3",{attrs:{id:"pvdisplay：查看组成lvm卷的物理卷。"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#pvdisplay：查看组成lvm卷的物理卷。"}},[s._v("#")]),s._v(" pvdisplay：查看组成LVM卷的物理卷。")]),s._v(" "),t("h3",{attrs:{id:"pvcreate：创建物理卷。"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#pvcreate：创建物理卷。"}},[s._v("#")]),s._v(" pvcreate：创建物理卷。")]),s._v(" "),t("p",[s._v("（可以在硬盘上或其中某个分区上创建。）")]),s._v(" "),t("h3",{attrs:{id:"vgcreate：创建卷组。"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#vgcreate：创建卷组。"}},[s._v("#")]),s._v(" vgcreate：创建卷组。")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",[t("code",[s._v("例：vgcreate myvolumn /dev/sdd1 /dev/sdc2。其中sdd1和sdc2都为物理卷。）\n")])])]),t("h3",{attrs:{id:"vgextend："}},[t("a",{staticClass:"header-anchor",attrs:{href:"#vgextend："}},[s._v("#")]),s._v(" vgextend：")]),s._v(" "),t("p",[s._v("在卷组里添加一个新的物理卷。（例：vgextend myvolumn /dev/sdd3。）")]),s._v(" "),t("h3",{attrs:{id:"lvdisplay：查看逻辑卷。"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#lvdisplay：查看逻辑卷。"}},[s._v("#")]),s._v(" lvdisplay：查看逻辑卷。")]),s._v(" "),t("h3",{attrs:{id:"lvcreate：创建一个逻辑卷。"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#lvcreate：创建一个逻辑卷。"}},[s._v("#")]),s._v(" lvcreate：创建一个逻辑卷。")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",[t("code",[s._v("例：lvcreate -l 50 myvolumn -n \n")])])]),t("p",[s._v("mylogical创建一个/dev/myvolumn/mylogical的新设备，")]),s._v(" "),t("p",[s._v("可以用于挂载：mkfs -j /dev/myvolume/mylogical")]),s._v(" "),t("p",[s._v("mount -t ext3 /dev/myvolumn/mylogical /mnt/mynewdisk。-l")]),s._v(" "),t("p",[s._v("50表示大小为50个PE，每个PE大小可能为4.0M，而-L指定LV的size。-n指定LV的名字。）")]),s._v(" "),t("h3",{attrs:{id:"lvextend：扩展逻辑卷。（如果有多余的pe，可以扩展逻辑卷的大小。例：lvextend-l-800m-dev-myvolumn-mylogical。）"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#lvextend：扩展逻辑卷。（如果有多余的pe，可以扩展逻辑卷的大小。例：lvextend-l-800m-dev-myvolumn-mylogical。）"}},[s._v("#")]),s._v(" lvextend：扩展逻辑卷。（如果有多余的PE，可以扩展逻辑卷的大小。例：lvextend -L 800M /dev/myvolumn/mylogical。）")])])}),[],!1,null,null,null);a.default=n.exports}}]);