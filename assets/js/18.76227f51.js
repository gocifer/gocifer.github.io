(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{433:function(t,s,e){"use strict";e.r(s);var a=e(6),n=Object(a.a)({},(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"linux服务管理"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#linux服务管理"}},[t._v("#")]),t._v(" Linux服务管理")]),t._v(" "),e("h2",{attrs:{id:"服务分类"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#服务分类"}},[t._v("#")]),t._v(" 服务分类")]),t._v(" "),e("table",[e("tr",[e("td",{attrs:{rowspan:"3"}},[t._v("Linux服务")]),t._v(" "),e("td",{attrs:{rowspan:"2"}},[t._v("RPM包默认"),e("br"),t._v("安装的服务")]),t._v(" "),e("td",[t._v("独立的服务")])]),t._v(" "),e("tr",[e("td",[t._v("基于xinetd服务")])]),t._v(" "),e("tr",[e("td",{attrs:{colspan:"2"}},[t._v("源码包安装的服务")])])]),t._v(" "),e("blockquote",[e("p",[t._v("其实之所以分成这样3类，要用不同的管理方法来管理，归根到底是服务的安装位置不同")])]),t._v(" "),e("ul",[e("li",[t._v("服务启动")]),t._v(" "),e("li",[t._v("服务自启动")])]),t._v(" "),e("blockquote",[e("p",[e("strong",[t._v("rpm安装服务和源码包安装服务的区别")])]),t._v(" "),e("ul",[e("li",[t._v("源码包安装在指定位置，一般是"),e("code",[t._v("/usr/local")])]),t._v(" "),e("li",[t._v("rpm包安装在默认位置中，在SysV服务管理系统中，启动脚本一般默认放在"),e("code",[t._v("/etc/rc.d/init.d")]),t._v(",service命令默认只能管理rpm安装的服务正是因为它默认搜索"),e("code",[t._v("/etc/rc.d/init.d")]),t._v("目录下的服务")])])]),t._v(" "),e("h3",{attrs:{id:"查询已安装的服务"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#查询已安装的服务"}},[t._v("#")]),t._v(" 查询已安装的服务")]),t._v(" "),e("ul",[e("li",[t._v("rpm包安装的服务："),e("code",[t._v("chkconfig --list")]),t._v("可以看到所有rpm包服务的自启动状态")])]),t._v(" "),e("blockquote",[e("p",[t._v("查看服务当前运行状态一般用"),e("code",[t._v("ps -aux | grep")]),t._v(",而"),e("code",[t._v("netstat -tlun")]),t._v("只能看到占用端口的服务状态")])]),t._v(" "),e("ul",[e("li",[t._v("源码包安装的服务：查看服务安装的位置，一般是/usr/local下")])]),t._v(" "),e("h2",{attrs:{id:"rpm服务管理"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#rpm服务管理"}},[t._v("#")]),t._v(" RPM服务管理")]),t._v(" "),e("ul",[e("li",[t._v("rpm包服务安装的默认位置")])]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",[t._v("位置")]),t._v(" "),e("th",[t._v("作用")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[e("code",[t._v("/etc")])]),t._v(" "),e("td",[t._v("配置文件位置")])]),t._v(" "),e("tr",[e("td",[e("code",[t._v("/etc/sysconfig")])]),t._v(" "),e("td",[t._v("初始化环境配置文件位置")])]),t._v(" "),e("tr",[e("td",[e("code",[t._v("/etc/xineted.conf")])]),t._v(" "),e("td",[t._v("xinetd本身配置文件")])]),t._v(" "),e("tr",[e("td",[e("code",[t._v("/etc/init.d")])]),t._v(" "),e("td",[e("code",[t._v("/etc/rc.d/init.d")]),t._v("的软链接,(SysV服务管理系统中)独立服务启动脚本的位置")])]),t._v(" "),e("tr",[e("td",[e("code",[t._v("/etc/xineted.d")])]),t._v(" "),e("td",[t._v("基于xinetd服务的启动脚本存放位置")])]),t._v(" "),e("tr",[e("td",[e("code",[t._v("/var/lib")])]),t._v(" "),e("td",[t._v("服务产生的数据位置")])]),t._v(" "),e("tr",[e("td",[e("code",[t._v("/var/log")])]),t._v(" "),e("td",[t._v("日志")])])])]),t._v(" "),e("blockquote",[e("p",[t._v("除了这些目录，部分rpm包还会有自己特殊文件的保存目录，不如httpd会把网页文件存放在"),e("code",[t._v("/var/www/html")]),t._v("目录下")])]),t._v(" "),e("h3",{attrs:{id:"独立服务管理"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#独立服务管理"}},[t._v("#")]),t._v(" 独立服务管理")]),t._v(" "),e("h4",{attrs:{id:"启动"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#启动"}},[t._v("#")]),t._v(" 启动")]),t._v(" "),e("p",[e("code",[t._v("/etc/init.d/独立服务名 start|stop|status|restart")])]),t._v(" "),e("p",[e("code",[t._v("service 独立服务名 start|stop|restart|status")])]),t._v(" "),e("blockquote",[e("p",[t._v("这两者本质上都是进入"),e("code",[t._v("/etc/init.d/")]),t._v("目录下寻找服务，然后对其操作\n"),e("code",[t._v("service")]),t._v("命令是红帽为了简化操作专门开发出的专有命令")])]),t._v(" "),e("blockquote",[e("p",[e("code",[t._v("service --status-all")]),t._v("列出SysV服务管理系统下的所有服务状态")])]),t._v(" "),e("h4",{attrs:{id:"自启动"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#自启动"}},[t._v("#")]),t._v(" 自启动")]),t._v(" "),e("ul",[e("li",[e("p",[e("code",[t._v("chkconfig --level 2345 httpd on")]),t._v("//默认级别就是2345，所以可以直接"),e("code",[t._v("chkconfig httpd on")])])]),t._v(" "),e("li",[e("p",[t._v("（建议）修改"),e("code",[t._v("/etc/rc.d/rc.local")]),t._v("文件（如果有）")])])]),t._v(" "),e("blockquote",[e("p",[t._v("在每次计算机启动完所有服务之后，在用户输入登录密码之前，系统会自动读取这个文件，执行里面的命令，所以只要把启动命令加入文件中就能实现开机自启动")])]),t._v(" "),e("ul",[e("li",[t._v("使用ntsysv命令管理自启动")])]),t._v(" "),e("blockquote",[e("ul",[e("li",[t._v("图形界面，给自启动的服务打"),e("code",[t._v("*")])]),t._v(" "),e("li",[t._v("不仅可以自启动独立服务，还可以自启动基于xinetd服务")]),t._v(" "),e("li",[t._v("红帽专有命令")])])]),t._v(" "),e("h3",{attrs:{id:"基于xinetd服务管理"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#基于xinetd服务管理"}},[t._v("#")]),t._v(" 基于xinetd服务管理")]),t._v(" "),e("ul",[e("li",[t._v("描述：超级守护进程，由于该服务本身不安全，使用比较少，只有有部分不安全的服务依然基于xinetd。")]),t._v(" "),e("li",[t._v("xinetd本身是独立服务，存在于内存，但是其所管理的服务只有在xinetd响应之后才会运行，可以减少内存占用")]),t._v(" "),e("li",[t._v("启动服务")])]),t._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("vim")]),t._v(" /etc/xinitd.d/telnet\n\n\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("service")]),t._v(" telnet          "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 服务名称")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    flag    "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("REUSE      "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 标记REUSE，设定TCP/IP socket可重用")]),t._v("\n    socket_type     "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("stream "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 使用TCP协议数据包")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("wait")]),t._v("    "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("no "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 允许多个连接同时进行")]),t._v("\n    user    "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("root   "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 启动服务的用户")]),t._v("\n    server  "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/usr/sbin/in.telnetd   "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 服务的启动程序")]),t._v("\n    log_on_failaure "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v("USERID    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 登录失败后，记录用户的ID")]),t._v("\n    disable "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("no "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 启动服务")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("service")]),t._v(" xinetd restart\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br"),e("span",{staticClass:"line-number"},[t._v("11")]),e("br"),e("span",{staticClass:"line-number"},[t._v("12")]),e("br"),e("span",{staticClass:"line-number"},[t._v("13")]),e("br"),e("span",{staticClass:"line-number"},[t._v("14")]),e("br"),e("span",{staticClass:"line-number"},[t._v("15")]),e("br"),e("span",{staticClass:"line-number"},[t._v("16")]),e("br")])]),e("ul",[e("li",[e("p",[t._v("自启动")]),t._v(" "),e("ul",[e("li",[e("code",[t._v("chkconfig telnet on")])]),t._v(" "),e("li",[e("code",[t._v("ntsysv")])])])]),t._v(" "),e("li",[e("p",[t._v("注意：")])])]),t._v(" "),e("blockquote",[e("p",[t._v("基于xinetd的服务没有严格的启动与自启动区分，修改一项另外一项也会随之改变")])]),t._v(" "),e("h2",{attrs:{id:"源码包服务的管理"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#源码包服务的管理"}},[t._v("#")]),t._v(" 源码包服务的管理")]),t._v(" "),e("ul",[e("li",[t._v("启动")])]),t._v(" "),e("blockquote",[e("p",[t._v("归根到底，还是调用启动骄傲本来启动。\n不同源码包启动脚本不同，查看安装说明。")])]),t._v(" "),e("ul",[e("li",[t._v("自启动")])]),t._v(" "),e("blockquote",[e("p",[t._v("修改"),e("code",[t._v("/etc/rc.d/rc.local")])])]),t._v(" "),e("ul",[e("li",[t._v("让源码包服务被服务管理命令识别(不建议 )")])]),t._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 可以让 service 命令识别")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("ln")]),t._v(" -s Path/of/Service /etc/init.d/SeviceName\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 可以让 chkconfig和 ntsysv 命令识别")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("vim")]),t._v(" /etc/init.d/ServiceName\n\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#!/bin/sh")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# chkconfig: 35 86 76")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# description: 运行级别 启动顺序 关闭顺序")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#上面 chkconfig 和 description 两行必须要有才会被chkconfig识别")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#启动顺序（S+num+service）和关闭顺序（K+num+service）不能与现有顺序重合")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("chkconfig")]),t._v(" --add ServiceName\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("chkconfig")]),t._v(" --del ServiceName\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br"),e("span",{staticClass:"line-number"},[t._v("11")]),e("br"),e("span",{staticClass:"line-number"},[t._v("12")]),e("br"),e("span",{staticClass:"line-number"},[t._v("13")]),e("br"),e("span",{staticClass:"line-number"},[t._v("14")]),e("br"),e("span",{staticClass:"line-number"},[t._v("15")]),e("br")])]),e("h2",{attrs:{id:"systemd-服务管理"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#systemd-服务管理"}},[t._v("#")]),t._v(" systemd 服务管理")]),t._v(" "),e("h3",{attrs:{id:"新建systemd-服务管理"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#新建systemd-服务管理"}},[t._v("#")]),t._v(" 新建systemd 服务管理")])])}),[],!1,null,null,null);s.default=n.exports}}]);