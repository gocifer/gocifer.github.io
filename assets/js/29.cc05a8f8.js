(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{444:function(s,a,e){"use strict";e.r(a);var n=e(6),t=Object(n.a)({},(function(){var s=this,a=s.$createElement,e=s._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("p",[s._v("[toc]")]),s._v(" "),e("h2",{attrs:{id:"客户端"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#客户端"}},[s._v("#")]),s._v(" 客户端")]),s._v(" "),e("p",[s._v("[toc]")]),s._v(" "),e("h1",{attrs:{id:"proxy-private-client"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#proxy-private-client"}},[s._v("#")]),s._v(" Proxy_Private(Client)")]),s._v(" "),e("p",[s._v("在日常我们遇到以下这些情况时，需考虑科学上网：")]),s._v(" "),e("ul",[e("li",[s._v("访问的网站或服务被（GFW）墙；")]),s._v(" "),e("li",[s._v("网络提供商（ISP）劫持了网络流量；")]),s._v(" "),e("li",[s._v("需要匿名（隐藏真实 IP）的情况，如渗透测试；")]),s._v(" "),e("li",[s._v("躲避网络监控；")])]),s._v(" "),e("p",[s._v("使用到的工具软件可能有 Shadowsocks、Lantern、Privoxy、Tor。\n根据不同的目的选择不同的工具。")]),s._v(" "),e("h2",{attrs:{id:"analyse"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#analyse"}},[s._v("#")]),s._v(" Analyse")]),s._v(" "),e("h3",{attrs:{id:"绕过-gfw-和-isp-劫持"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#绕过-gfw-和-isp-劫持"}},[s._v("#")]),s._v(" 绕过 GFW 和 ISP 劫持")]),s._v(" "),e("p",[s._v("最简单和不折腾的方法是购买 VPN，次之是购买一台海外 VPS，自己安装 VPN 或 Shadowsocks 服务端。VPN 的优点是可以全局翻墙，Shadowsocks 虽然可以设置全局模式，但是对于不支持代理的本地应用是没有办法的，当然这种情况下可以试试 ProxifierPE 强制所有连接通过代理上网。")]),s._v(" "),e("h3",{attrs:{id:"匿名上网"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#匿名上网"}},[s._v("#")]),s._v(" 匿名上网")]),s._v(" "),e("p",[s._v("网络中保持匿名的办法是使用 Tor，匿名的意思是隐藏你当前的 IP 地址。Internet 上有很多志愿者运行着 Tor 中继节点，Tor 能保证从出发点的流量至少经过三个不同的中继节点到达目的地址，而且这三个不同的中继不会每次都相同。")]),s._v(" "),e("p",[s._v("形象地说，你想把一封匿名信交给小明，在大街上随便找了一陌生人 A 让 A 帮忙转交，A 走了一段路程后随便找了一个陌生人 B 让 B 帮忙转交，B 走了一段路程后随便找了一个陌生人 C 让 C 帮忙转交，最终 C 按照信封上的地址找到了小明并把信交给了他。小明只知道是 C 转交了这封信，至于是谁写的这封信，他就无从得知了。A、B、C 分别对应着 Tor 网络的中继节点，这种投递匿名信的方式就起到了隐藏 IP 地址的效果。")]),s._v(" "),e("p",[s._v("如下图所示，使用 Tor 从本机经过三跳访问了 Google。\n"),e("img",{attrs:{src:"https://note.youdao.com/yws/res/7759/WEBRESOURCE7bdc81cea5caec6ae31889e3045b3070",alt:"tor.png"}})]),s._v(" "),e("h2",{attrs:{id:"shadowsocks-r"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#shadowsocks-r"}},[s._v("#")]),s._v(" shadowsocks(R)")]),s._v(" "),e("blockquote",[e("ul",[e("li",[s._v("https://netboost.app")])])]),s._v(" "),e("h3",{attrs:{id:"ss"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ss"}},[s._v("#")]),s._v(" ss")]),s._v(" "),e("blockquote",[e("p",[e("a",{attrs:{href:"https://github.com/shadowsocks/shadowsocks/wiki/Ports-and-Clients#windows%20SS%E5%85%A8%E5%B9%B3%E5%8F%B0%E5%90%84%E4%B8%AA%E7%89%88%E6%9C%AC",target:"_blank",rel:"noopener noreferrer"}},[s._v("SS全平台各个版本 - Github"),e("OutboundLink")],1)])]),s._v(" "),e("h4",{attrs:{id:"ss安装"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ss安装"}},[s._v("#")]),s._v(" ss安装")]),s._v(" "),e("ul",[e("li",[s._v("ss-qt5")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" add-apt-repository ppa:hzwhuang/ss-qt5\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" update\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" shadowsocks-qt5\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("ul",[e("li",[s._v("debian based")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("sudo add-apt-repository ppa:hzwhuang/ss-qt5\nsudo apt-get update\nsudo apt-get install shadowsocks-qt5\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("ul",[e("li",[s._v("cent")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("yum install python-setuptools && easy_install pip\npip install shadowsocks\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("ul",[e("li",[s._v("pip")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("sudo apt-get install python-pip\nsudo apt-get install python-setuptools m2crypto\npip install --upgrade pip\npip install shadowsocks\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("blockquote",[e("p",[s._v("Pip 是 Python 的包管理工具，这里我们用 pip 安装 shadowsocks，有些文章会介绍用 yum install -y pip 安装，如果没有这个包，可以手动安装。")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('curl "https://bootstrap.pypa.io/get-pip.py" -o "get-pip.py"\npython get-pip.py\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h4",{attrs:{id:"ss运行"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ss运行"}},[s._v("#")]),s._v(" ss运行")]),s._v(" "),e("ul",[e("li",[s._v("参数含意使用 "),e("code",[s._v("sslocal -h")])]),s._v(" "),e("li",[s._v("命令行调用:"),e("code",[s._v('sslocal -s 11.22.33.44 -p 50003 -k "123456" -l 1080-t600 -m aes-256-cfb')])]),s._v(" "),e("li",[s._v("为了方便我推荐直接用 sslcoal -c 配置文件 这样的方式，简单好用。")])]),s._v(" "),e("p",[s._v("配置文件：")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[s._v('{\n "server":"x.x.x.x",             #你的 ss 服务器 ip\n "server_port":0,                #你的 ss 服务器端口\n  "local_address": "127.0.0.1",   #本地ip\n  "local_port":0,                 #本地端口\n "password":"password",          #连接 ss 密码\n "timeout":300,                  #等待超时\n "method":"aes-256-cfb",         #加密方式\n "fast_open": false,             #开启或关闭 TCP_FASTOPEN, 填true /false，需要服务端支持\n "workers": 1                    #工作线程数,只有unix/linux下可用\n \n}\n')])])]),e("ul",[e("li",[s._v("启动")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('nohup sslocal -c /etc/shadowsocks.json /dev/null 2>&1 &\n# 放到后台，输出重定向\necho " nohup sslocal -c /etc/shadowsocks.json /dev/null 2>&1 &" /etc/rc.local   #设置自启动\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("ul",[e("li",[e("p",[s._v("测试\n运行"),e("code",[s._v("curl --socks5 127.0.0.1:1985 http://httpbin.org/ip")]),s._v("，如果返回你的 ss 服务器 ip 则测试成功：")])]),s._v(" "),e("li",[e("p",[s._v("启动脚本")])])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("#！/bin/bash\n#shadow.sh\nsslocal -c /etc/shadowsocks.json\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("sh /home/shadow.sh &。\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("ul",[e("li",[s._v("加入开机自启")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("vim /etc/rc.loca\n在exit之前输入nohup bash /home/shadow.sh>/home/d.txt & \n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("ul",[e("li",[s._v("查看ss是否已经开启，用下面这个:\n"),e("code",[s._v("ps -ef | grep sslocal")])])]),s._v(" "),e("h3",{attrs:{id:"ssr"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ssr"}},[s._v("#")]),s._v(" ssr")]),s._v(" "),e("h4",{attrs:{id:"ssr安装"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ssr安装"}},[s._v("#")]),s._v(" ssr安装")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("election-ssr")])]),s._v(" "),e("li",[e("p",[s._v("Get ShadowsocksR from Github:")])])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("git clone -b manyuser https://github.com/shadowsocksrr/shadowsocksr.git\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("ul",[e("li",[s._v("Edit your initial ShadowsocksR configuration file:")])]),s._v(" "),e("blockquote",[e("p",[s._v("配置模板文件位于shadowsocksr/user-config.json，修改该文件（也可复制一个新文件份到/etc/shadowsocks.json再修改，下一步脚本中的配置文件路径也要一起修改）")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('{\n    "server": "0.0.0.0",\n    "server_ipv6": "::",\n    "server_port": 8388,\n    "local_address": "127.0.0.1",\n    "local_port": 1080,\n\n    "password": "m",\n    "method": "aes-128-ctr",\n    "protocol": "auth_aes128_md5",\n    "protocol_param": "",\n    "obfs": "tls1.2_ticket_auth_compatible",\n    "obfs_param": "",\n    "speed_limit_per_con": 0,\n    "speed_limit_per_user": 0,\n\n    "additional_ports" : {}, // only works under multi-user mode\n    "additional_ports_only" : false, // only works under multi-user mode\n    "timeout": 120,\n    "udp_timeout": 60,\n    "dns_ipv6": false,\n    "connect_verbose_info": 0,\n    "redirect": "",\n    "fast_open": false\n}\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br")])]),e("p",[s._v("主要用到的配置是下面的这几个选项：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('"server_port":8388,        //端口\n"password":"password",     //密码\n "protocol":"origin",       //协议插件\n "obfs":"http_simple",      //混淆插件\n "method":"aes-256-cfb",    //加密方式\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("p",[s._v("具体的服务器，密码，端口从SS帐号提供商那里获取")]),s._v(" "),e("ul",[e("li",[s._v("Edit run script")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('#!/bin/bash\n\nstatus(){\nif[!-f"/var/run/shadowsocksr.pid"];\nthen\necho"服务未启动"\nelse\necho"服务运行中..."\nfi\n}\nif[x$1==x]\nthen\nstatus\necho"操作参数：start/stop/restart/status"\nexit\nfi\ncase$1in\nstatus)\nstatus\n;;\n*)\nsudo python~/shadowsocksr/shadowsocks/local.py-c~/shadowsocksr/user-config.json-d$1\n;;\nesac\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br")])]),e("p",[s._v("文件保存到 /usr/bin 或 PATH 所在的其他目录，命名为 ssr。")]),s._v(" "),e("p",[s._v("脚本中的 ~ 可能需要按自己的实际位置修改。")]),s._v(" "),e("h4",{attrs:{id:"ssr运行"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ssr运行"}},[s._v("#")]),s._v(" ssr运行")]),s._v(" "),e("ul",[e("li",[s._v("直接运行")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("## Change into the directory for the single-user version of SSR:\ncd shadowsocksr/shadowsocks\n\n## Start the ShadowsocksR client running as a daemon:\nsudo python local.py -c /etc/shadowsocks.json -d start\n\nCheck that it is running okay:\n## sudo tail /var/log/shadowsocksr.log\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("ul",[e("li",[s._v("调用脚本")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("ssr start   # 启动\nssr stop    # 停止\nssr restart # 重启\nssr status  # 状态\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("h2",{attrs:{id:"shadowsocks-privoxy"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#shadowsocks-privoxy"}},[s._v("#")]),s._v(" Shadowsocks_Privoxy")]),s._v(" "),e("blockquote",[e("p",[s._v("使用 Shadowsocks 可能遇到的另一个问题是，因为 Shadowsocks 使用的是 SOCKS5 类型的代理，当本地应用只支持 HTTP/HTTPS 类型代理时，就需要自己解决 HTTP 转换为 SOCKS5 的问题。当然，这个问题使用 Privoxy 就能很好地解决。")])]),s._v(" "),e("p",[s._v("Shadowsocks 与 Privoxy 组合使用的示意图如下所示：")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://note.youdao.com/yws/res/7744/WEBRESOURCE4cef529bd1195bd724c7e1a1bdb80ddc",alt:"Shadowsocks Privoxy 组合使用示意图"}})]),s._v(" "),e("p",[s._v("假设你已经配置好了 Shadowsocks，接下来配置 Privoxy:")]),s._v(" "),e("ul",[e("li",[s._v("Windows 系统中右键点击 Privoxy 托盘图标，依次点击 Edit - Main Configuration 打开配置文件；")]),s._v(" "),e("li",[s._v("Linux 系统中 Privoxy 的配置文件位于/etc/privoxy/config。")])]),s._v(" "),e("p",[s._v("配置文件修改为：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# 把 HTTP 流量转发到本机 127.0.0.1:1080 的 Shadowsocks\nforward-socks5 / 127.0.0.1:1080 .\n\n# 可选，默认只监听本地连接 127.0.0.1:8118\n# 可以允许局域网中的连接\nlisten-address 0.0.0.0:8118\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("p",[s._v("启动 Shadowsocks 和 Privoxy 后，把本地应用的代理设置为 HTTP/HTTPS 类型的 127.0.0.1:8118，就可以绕过 GFW 和 ISP 了。如果局域网中的其他 PC 或手机也希望使用该电脑上网（假设该电脑 IP 地址为 192.168.1.10），把它们的代理设置为 19.168.1.10:8118 即可。")]),s._v(" "),e("h2",{attrs:{id:"lantern"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#lantern"}},[s._v("#")]),s._v(" Lantern")]),s._v(" "),e("blockquote",[e("p",[s._v("目前，有一个讨巧的的办法替代这两者的组合：使用 Lantern —— 一款开源的安全上网工具。它使用的是 HTTP 类型代理，本地端口为 8787，也就是说，把本地应用的代理设置为 127.0.0.1:8787 就可以使用 HTTP 类型的代理了。而且使用它，也无需自己购买 VPS。")])]),s._v(" "),e("p",[s._v("Lantern 默认非全局代理，可以在设置中改为全局模式。")]),s._v(" "),e("p",[s._v("另一方面，Lantern 只监听本机 127.0.0.1:8787 的连接，如果局域网中的电脑或手机也想通过这台电脑翻墙（假设该电脑 IP 地址为 192.168.1.10），那么也需要配合 Privoxy 使用。这时，Privoxy 的配置应该如下：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# 监听局域网中连接到本地 8118 端口的连接，转发给 8787 端口的 Lantern\nforward / 127.0.0.1:8787\nlisten-address 127.0.0.1:8118    # 可改为 0.0.0.0:8118 允许局域网的连接\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("h2",{attrs:{id:"tor-browster"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#tor-browster"}},[s._v("#")]),s._v(" Tor_browster")]),s._v(" "),e("p",[s._v("为了方便使用 Tor，Tor 开发者把 Tor 集成到了定制版的 Firefox 中，简单设置一下就能正常使用。")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("Tor 浏览器专为大陆等网络环境加入了流量混淆的选项。")])]),s._v(" "),e("li",[e("p",[s._v("首次打开浏览器时会弹出 Tor 状态检查，点击设置配置 Tor 网桥")])]),s._v(" "),e("li",[e("p",[s._v("勾选"),e("strong",[s._v("互联网提供商（ISP）是否对 Tor 网络连接进行了封锁或审查")]),s._v("中的"),e("strong",[s._v("是")])])]),s._v(" "),e("li",[e("p",[s._v("把下一步中的网桥类型选择"),e("strong",[s._v("meek-amazon")]),s._v("或"),e("strong",[s._v("meek-azure")]),s._v("。这两者在大陆没被完全封锁，因此可以用来做跳板网桥。")])]),s._v(" "),e("li",[e("p",[s._v("不过随着网络环境的恶化，Tor 提供的网桥类型都不可用时，就需要使用自己的 Shadowsocks 或 Lantern 代理了")]),s._v(" "),e("ul",[e("li",[s._v("在 Tor 设置中勾选互联网提供商（ISP）是否对 Tor 网络连接进行了封锁或审查中的否")]),s._v(" "),e("li",[s._v("在下一步是否需要本地代理访问互联网？中选择是，下一步中设置你的代理：")]),s._v(" "),e("li",[s._v("使用 Shadowsocks 则设置为 SOCKS5 类型的 127.0.0.1:1080")]),s._v(" "),e("li",[s._v("使用 Lantern 则设置为 HTTP/HTTPS 类型的 127.0.0.1:8787")]),s._v(" "),e("li",[s._v("如果通过局域网中其他计算机的配置联网，把 127.0.0.1 改为那台计算机的 IP 地址。")])])])]),s._v(" "),e("p",[s._v("使用了代理的 Tor 浏览器原理示意图如下（以 Tor + Shadowsocks 组合为例）：\n"),e("img",{attrs:{src:"https://note.youdao.com/yws/res/7790/WEBRESOURCEc38fa3d452f43cd07df131c6524b4c9b",alt:"w8b4bwe.png"}})]),s._v(" "),e("h2",{attrs:{id:"tor-expert-bundle"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#tor-expert-bundle"}},[s._v("#")]),s._v(" Tor Expert Bundle")]),s._v(" "),e("blockquote",[e("p",[s._v("Tor 浏览器适用于使用浏览器匿名上网的场景，如果打算让本地应用（如其他浏览器、Linux 中的 Terminal 等）也使用 Tor 隐藏 IP 地址，那么就需要自己手动配置 Tor 了。从 Tor 官网下载 操作系统对应的 Expert Bundle，它只包含 Tor 工具，不含浏览器。")])]),s._v(" "),e("p",[s._v("假设你已经配置好了 Shadowsocks，接下来，为 Tor 配置 Shadowsocks 代理。")]),s._v(" "),e("ul",[e("li",[s._v("Windows 系统中，打开 %AppData%/tor 目录（如果不存在则创建该目录），新建 torrc 文件;")]),s._v(" "),e("li",[s._v("Linux 系统中，Tor 的配置文件位于 /etc/tor/torrc")]),s._v(" "),e("li",[s._v("内容")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("## 通过 SOCKS5 代理\nSOCKS5Proxy 127.0.0.1:1080\n## 如果使用 HTTP/HTTPS 代理\n# HTTPSProxy 127.0.0.1:8118\n\n## 如果只允许特定端口的网络连接，如 80 和 443\nReachableAddresses *:80,*:443\nReachableAddresses reject *:*\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("p",[s._v("启动 Shadowsocks 和 Tor，因为 Tor 监听的是 SOCKS5 类型的本地 9050 端口，把需要匿名的本地应用代理设置为 SOCKS5 类型，代理地址设置为 127.0.0.1:9050，实现匿名上网。")]),s._v(" "),e("p",[s._v("还是老问题，如果本地应用只支持 HTTP/HTTPS 代理类型，那么仍需要使用 Privoxy，修改其配置文件为：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("forward-socks5 / 127.0.0.1:9050 .\nlisten-address 127.0.0.1:8118    # 可改为 0.0.0.0:8118 允许局域网的连接\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("p",[s._v("这样一来，本地应用的代理设置为 HTTP/HTTPS 类型的 127.0.0.1:8118 就可以实现匿名上网了。")]),s._v(" "),e("p",[s._v("Privoxy + Tor + Shadowsocks 组合使用示意图如下所示：")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://note.youdao.com/yws/res/7800/WEBRESOURCE6a3ef3a96ffaff8517553d5786ffae0c",alt:"Privoxy + Tor + Shadowsocks 组合使用示意图"}})]),s._v(" "),e("h2",{attrs:{id:"socks-to-http"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#socks-to-http"}},[s._v("#")]),s._v(" socks_to_http")]),s._v(" "),e("blockquote",[e("p",[s._v("https://github.com/ginuerzh/gost")])]),s._v(" "),e("h3",{attrs:{id:"tsocks"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#tsocks"}},[s._v("#")]),s._v(" tsocks")]),s._v(" "),e("p",[s._v("准备工作需要一个可用的 http 代理或者 ssh 代理，用于在没有配好 ss 的时候无痛连接 github 和更新 PPA，不然脸黑的话apt-get update 能卡半天。")]),s._v(" "),e("p",[s._v("如果你使用的是 http 代理，请使用：")]),s._v(" "),e("p",[e("code",[s._v("export http_proxy=http://yourproxyaddress:proxyport")])]),s._v(" "),e("p",[s._v("这条命令将临时修改你的全局代理环境变量也就是会影响你所有软件。")]),s._v(" "),e("p",[s._v("如果你没有 http 代理，请使用：")]),s._v(" "),e("p",[e("code",[s._v("ssh -N -D 8888 user@hostname")])]),s._v(" "),e("p",[s._v("其中8888是本地端口号，user@hostname 是你的 ssh 帐号和服务器，这条命令将把你 ssh 服务器的端口绑定到本地的8888端口，那么你本机127.0.0.1:8888将成为一个 socks 代理，-N 参数表示不打开远端的命令行。 然后你需要将任何软件通过 socks 代理使用的工具：tsocks，我们将使用它让 apt-get 通过代理更新。")]),s._v(" "),e("p",[s._v("如果有Shadowsocks也可以，要保证其是打开的，下面是tsocks的使用")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("apt-get update\napt-get install tsocks\nvim /etc/tsocks.conf\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("    local = 192.168.1.0/255.255.255.0  # local表示本地的网络，也就是不使用socks代理的网络\n    local = 10.0.0.0/255.0.0.0  # 用ifconfig查看一下当前的IP地址\n    local = 127.0.0.0/255.0.0.0  # Path那段可以注释掉\n    server = 127.0.0.1\n    server_type = 5  # socks 类型，ssh 和 shadowsocks 都是 sock5\n    server_port = 1080  # 端口是刚才绑定的8888,如果是本机shadowsocks,就用1080\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("p",[s._v("需要注意的一点是如果你使用的代理服务器不是本机，但其 IP 不在 local 的 IP 段里会报错：SOCKS server xxx.xx.xxx.xxx (xxx.xxx.xxx.xxx) is not on a local subnet 只要保持 ssh -D 进程存在，任何需要代理的工作都可以简单的在命令前加 tsocks，如")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("tsocks apt-get update\ntsocks wget www.google.com\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("p",[s._v("但是tsocks ping google.com 不行\n如果代理服务器需要登陆，这时可以直接把用户名和密码写进去\n"),e("code",[s._v("http_proxy=http://userName:password@proxyAddress:port")])]),s._v(" "),e("h3",{attrs:{id:"proxychains"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#proxychains"}},[s._v("#")]),s._v(" Proxychains")]),s._v(" "),e("p",[s._v("ProxyChains是Linux和其他Unices下的代理工具。 它可以使任何程序通过代理上网， 允许TCP和DNS通过代理隧道， 支持HTTP、 SOCKS4和SOCKS5类型的代理服务器， 并且可配置多个代理。 ProxyChains通过一个用户定义的代理列表强制连接指定的应用程序， 直接断开接收方和发送方的连接。")]),s._v(" "),e("p",[s._v("我告诉你,有,就是今天我要说的proxychains")]),s._v(" "),e("ul",[e("li",[s._v("apt包管理\n"),e("code",[s._v("sudo apt-get install proxychains")])]),s._v(" "),e("li",[s._v("源码编译安装")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("git clone https://github.com/rofl0r/proxychains-ng  \ncd proxychains-ng  \n./configure  \nsudo make && make install  \n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("ul",[e("li",[s._v("archlinux\t\t\n下载安装 shadowscocks")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# sudo pacman -S shadowsocks\n下载安装 proxychains\n# sudo pacman -S proxychains-ng\n　配置\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("ul",[e("li",[e("p",[s._v("MAC\nmac下 就直接下载 ss客户端，然后填写相关的vpn账号就ok，这里需要安装的是 proxychain\n"),e("code",[s._v("brew install proxychains-ng")])])]),s._v(" "),e("li",[e("p",[s._v("fedora\n"),e("code",[s._v("sudo dnf install proxychains")])])])]),s._v(" "),e("p",[s._v("安装完毕后，就按照下面面 proxychain 的配置方法配置后，可以按照上面的方式测试。")]),s._v(" "),e("p",[s._v("如果不生效，需要关闭 mac 上的 sip 具体参考 《这里》（https://zhuanlan.zhihu.com/p/21281236）")]),s._v(" "),e("hr"),s._v(" "),e("ul",[e("li",[s._v("配置socks\n默认会在  /etc/shadowsocks/ 目录下有个  example.json 文件，可以直接配置它，也可以重新复制一个文件 例如 叫 proxy.json，文件内容如下")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('{\n    "server":"my_server_ip", # 你的vps 或者 vpn的 ip地址，这里可以多个，多个的写法 ["my_server_ip1","my_server_ip2","my_server_ip3"]\n    "server_port":8388, # vps 或者 vpn服务器的端口\n    "local_address": "127.0.0.1", # 本地的ip\n    "local_port":1080, # 本地的 代理端口\n    "password":"mypassword", # vps 或者 vpn 账号的密码\n    "timeout":300,\n    "method":"aes-256-cfb", # 加密方式 这个需要跟 vps 或者 vpn 那边提供的加密方式一致\n    "fast_open": false,\n    "workers": 1,\n    "prefer_ipv6": false\n}\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br")])]),e("p",[s._v("修改完毕后，可以把这个客户端启动起来\n"),e("code",[s._v("sslocal -c /etc/shadowsocks/proxy.json")])]),s._v(" "),e("hr"),s._v(" "),e("ul",[e("li",[s._v("然后配置 proxychain\n安装完成之后你只要在proxychains.conf这个文件下添加一句话就可以了\n"),e("code",[s._v("vim /etc/proxychains.conf")]),s._v("\n在这个配置文件最下面有[ProxyList]这么一行,在这行下面添加上 socks5 127.0.0.1 1080 如果有别的比如 socks4 127.0.0.1 9050 那么就把它给注释掉")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("strict_chain\nproxy_dns \nremote_dns_subnet 224\ntcp_read_time_out 15000\ntcp_connect_time_out 8000\n[ProxyList]\n#1080 就是本地 ss 代理的端口\nsocks5     0.0.0.0 1080\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("p",[s._v("到此proxychain 配置完成，可以进行测试一下：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("curl myip.ipip.net\n当前 IP：xx.xx.xx.xx  来自于：中国 上海 上海  电信\nproxychains curl myip.ipip.net\n当前 IP：xx.xx.xx.xx  来自于：美国 加利福尼亚州 洛杉矶  it7.net\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("p",[s._v("如果是上面这样就代表ok 了。")]),s._v(" "),e("hr"),s._v(" "),e("ul",[e("li",[s._v("使用\n如果你只是给一个命令实现代理,比如你要git clone什么东西,你只要在这个命令前面加上 proxychains 这个命令就好,比如\n"),e("code",[s._v("proxychains git clone https://github.com/haad/proxychains.git")]),s._v(" "),e("code",[s._v("proxychains wget https://github.com/haad/proxychains/archive/proxychains-4.2.0.tar.gz")]),s._v("\n但是这样你还是觉得太麻烦怎么办,你要执行很多下载的动作,你可以使用proxychains去打开一个终端\n"),e("code",[s._v("proxychains zsh")])])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# 在 Ubuntu 上更新软件包\nsudo proxychains4 apt-get update\n\n# 安装 npm 依赖(国内慢得一B啊)\nproxychains4 npm install\n\n# 使用 docker(再也不用切换源了)\ndocker run helloworld\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("hr"),s._v(" "),e("ul",[e("li",[s._v("issue1.0\n"),e("code",[s._v("**** Seccomp prevented execution of syscall 0000000220 on architecture arm64 ****")])]),s._v(" "),e("li",[s._v("也有例外啦。这样使用并没有任何效果：\n"),e("code",[s._v("proxychains ping google.com")]),s._v("\n因为 proxychains 只会代理 TCP 连接，而 ping 使用的是 ICMP。记住这一点即可。")])]),s._v(" "),e("h3",{attrs:{id:"privoxy"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#privoxy"}},[s._v("#")]),s._v(" privoxy")]),s._v(" "),e("p",[s._v("一、 部署privoxy\n1.1 安装\n"),e("code",[s._v("yum install -y privoxy")]),s._v(" "),e("code",[s._v("$ sudo apt-get install privoxy")]),s._v("\t\n1.2 修改privoxy的config文件")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("vim /etc/privoxy/config \n# 增加下面的内容，wq保存。\n# 后面的.不要漏了\nforward-socks5t   /               127.0.0.1:1080 .\nlisten-address  localhost:8118\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("p",[s._v("1.3 启动")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# 启动\nsystemctl start privoxy\n# 开机启动\nsystemctl enable privoxy\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("p",[s._v("二、设置代理\n2.1 设置当前用户的全局代理\n修改bashrc文件\n"),e("code",[s._v("vim ~/.bashrc")])]),s._v(" "),e("p",[s._v("添加下面的内容，wq保存")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("export http_proxy=http://localhost:8118\nexport https_proxy=http://localhost:8118\nexport ftp_proxy=http://localhost:8118\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("p",[s._v("立刻生效\n"),e("code",[s._v("source ~/.bashrc")])]),s._v(" "),e("p",[s._v("2.2 设置系统全局代理")]),s._v(" "),e("p",[s._v("修改profile文件\n"),e("code",[s._v("vim /etc/profile")])]),s._v(" "),e("p",[s._v("添加下面的内容，wq保存。")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("http_proxy=http://127.0.0.1:8118\nhttps_proxy=http://u27.0.0.1:8118\nftp_proxy=http://27.0.0.1:8118\nexport http_proxy\nexport https_proxy\nexport ftp_proxy\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("p",[s._v("立即生效")]),s._v(" "),e("p",[e("code",[s._v("source /etc/profile")])]),s._v(" "),e("p",[s._v("注意端口是8123不是1080是polipo的默认端口不是ss的")]),s._v(" "),e("h2",{attrs:{id:"conclusion"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#conclusion"}},[s._v("#")]),s._v(" Conclusion")]),s._v(" "),e("p",[s._v("接下来简要归纳上述内容，给出每种组合的配置内容。")]),s._v(" "),e("h3",{attrs:{id:"privoxy-shadowsocks-组合-翻墙"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#privoxy-shadowsocks-组合-翻墙"}},[s._v("#")]),s._v(" Privoxy + Shadowsocks 组合 —— 翻墙")]),s._v(" "),e("p",[s._v("配置 Privoxy，Linux 系统中位于 /etc/privoxy/config：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("forward-socks5 / 127.0.0.1:1080 .\nlisten-address 127.0.0.1:8118    # 可改为 0.0.0.0:8118 允许局域网的连接\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("p",[s._v("本地代理需设置为 HTTP/HTTPS 类型的 127.0.0.1:8118。\n如果不使用 Privoxy，本地代理需设置为 SOCKS5 类型的 127.0.0.1:1080。")]),s._v(" "),e("h3",{attrs:{id:"privoxy-tor-shadowsocks-组合-匿名上网"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#privoxy-tor-shadowsocks-组合-匿名上网"}},[s._v("#")]),s._v(" Privoxy + Tor + Shadowsocks 组合 —— 匿名上网")]),s._v(" "),e("p",[s._v("配置 Privoxy，Linux 系统中位于 /etc/privoxy/config：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("forward-socks5 / 127.0.0.1:9050 .\nlisten-address 127.0.0.1:8118    # 可改为 0.0.0.0:8118 允许局域网的连接\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("p",[s._v("配置 Tor，Windows 系统中位于 %AppData%/tor/torrc，Linux 系统中位于 /etc/tor/torrc：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("SOCKS5Proxy 127.0.0.1:1080    # Shadowsocks 代理地址\nReachableAddresses *:80,*:443\nReachableAddresses reject *:*\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("p",[s._v("本地代理需设置为 HTTP/HTTPS 类型的 127.0.0.1:8118。\n如果不使用 Privoxy，本地代理需设置为 SOCKS5 类型的 127.0.0.1:9050。")]),s._v(" "),e("h3",{attrs:{id:"privoxy-tor-lantern-组合-匿名上网"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#privoxy-tor-lantern-组合-匿名上网"}},[s._v("#")]),s._v(" Privoxy + Tor + Lantern 组合 —— 匿名上网")]),s._v(" "),e("p",[s._v("配置 Privoxy，Linux 系统中位于 /etc/privoxy/config：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("forward-socks5 / 127.0.0.1:9050 .\nlisten-address 127.0.0.1:8118    # 可改为 0.0.0.0:8118 允许局域网的连接\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("p",[s._v("配置 Tor，Windows 系统中位于 %AppData%/tor/torrc，Linux 系统中位于 /etc/tor/torrc：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("HTTPSProxy 127.0.0.1:8787    # Lantern 代理地址\nReachableAddresses *:80,*:443\nReachableAddresses reject *:*\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("p",[s._v("本地代理需设置为 HTTP/HTTPS 类型的 127.0.0.1:8118。\n如果不使用 Privoxy，本地代理需设置为 SOCKS5 类型的 127.0.0.1:9050。")]),s._v(" "),e("h2",{attrs:{id:"小飞机配置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#小飞机配置"}},[s._v("#")]),s._v(" 小飞机配置")]),s._v(" "),e("ul",[e("li",[s._v("多用户")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('{\n    "server": "0.0.0.0",\n    "local_port": 1080,\n    "port_password": {\n        "9001":"password1",\n        "9002":"password2",\n        "9003":"password3"\n    },\n    "timeout": 300,\n    "method": "aes-256-cfb",\n    "local_address": "0.0.0.0",\n    "fast_open": false\n}\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br")])]),e("ul",[e("li",[s._v("每个字段的的解释：")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('Name\t说明\nserver   服务端监听的地址，填ip或域名\nserver_port     服务器的端口(只要不与现有的端口冲突，随你填写了，我填8137)\nlocal_address     本地监听的地址，直接写127.0.0.1\nlocal_port     本地的端口，随便写，只要不冲突，一般1080\nport_password\tserver_port + password ，服务器端口加密码的组合\npassword     你的shadowsocks连接密码\ntimeout     超时时间，超时重连\nmethod     加密方式。默认是: "aes-256-cfb", 详见[see](https://github.com/shadowsocks/shadowsocks/wiki/Encryption) \nworkers    应该是进程数，这个我没该，大家可以改后看看进程是否增多。不理解的化，就别改了，这个参数只有unix/linux下可用。\nfast_open\t开启或关闭 TCP_FASTOPEN, 填true / false，需要服务端支持\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br")])]),e("ul",[e("li",[e("p",[s._v("启动运行ss服务器端：\n"),e("code",[s._v("ssserver -c /etc/shadowsocks.json")])])]),s._v(" "),e("li",[e("p",[s._v("测试启动\n配置文件的路径改成自己的，如：/etc/shadowsocks.json")])])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("前端启动：sslocal -c /home/xx/Software/ShadowsocksConfig/shadowsocks.json；\n后端启动：sslocal -c /home/xx/Software/ShadowsocksConfig/shadowsocks.json -d start；\n后端停止：sslocal -c /home/xx/Software/ShadowsocksConfig/shadowsocks.json -d stop；\n重启(修改配置要重启才生效)：sslocal -c /home/xx/Software/ShadowsocksConfig/shadowsocks.json -d restart\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("ul",[e("li",[s._v("开机自启")])]),s._v(" "),e("p",[s._v("以下使用Systemd来实现shadowsocks开机自启。")]),s._v(" "),e("p",[e("code",[s._v("sudo vim /etc/systemd/system/shadowsocks.service")])]),s._v(" "),e("p",[s._v("在里面填写如下内容：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("[Unit]\nDescription=Shadowsocks Client Service\nAfter=network.target\n\n[Service]\nType=simple\nUser=root\nExecStart=/usr/bin/sslocal -c /home/xx/Software/ShadowsocksConfig/shadowsocks.json\n\n[Install]\nWantedBy=multi-user.target\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br")])]),e("p",[s._v("把/home/xx/Software/ShadowsocksConfig/shadowsocks.json修改为你的shadowsocks.json路径，如：/etc/shadowsocks.json")]),s._v(" "),e("ul",[e("li",[s._v("配置生效：\n"),e("code",[s._v("systemctl enable /etc/systemd/system/shadowsocks.service")]),s._v("\n输入管理员密码就可以了。")])]),s._v(" "),e("p",[s._v("现在你可以马上重启试试，或先在后台启动，等下次重启再看看！")]),s._v(" "),e("h1",{attrs:{id:"酸酸乳server"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#酸酸乳server"}},[s._v("#")]),s._v(" 酸酸乳Server")]),s._v(" "),e("blockquote",[e("p",[s._v("referred from:https://dcamero.azurewebsites.net/shadowsocksr.html")])]),s._v(" "),e("p",[s._v("Begin by visiting "),e("a",{attrs:{href:"https://www.digitalocean.com/?refcode=20245d9035f1&utm_campaign=Referral_Invite&utm_medium=Referral_Program&utm_source=CopyPaste",target:"_blank",rel:"noopener noreferrer"}},[s._v("DigitalOcean"),e("OutboundLink")],1),s._v(" and opening and funding an account. If you use my link, they may reward you with an extra credit when you add funds for the first time. Follow the remainder of the article "),e("a",{attrs:{href:"https://dcamero.azurewebsites.net/basic-linux-vps-windows-pc.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("Basic Linux VPS Set Up from a Windows PC"),e("OutboundLink")],1),s._v(" to create and set up your “droplet” (VPS).")]),s._v(" "),e("p",[s._v("Once you have done this, continue as follows.")]),s._v(" "),e("h2",{attrs:{id:"configure"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#configure"}},[s._v("#")]),s._v(" Configure")]),s._v(" "),e("p",[s._v("Choose a port that you will run ShadowsocksR on. In the rest of this article, we will use port 8388 as an example.")]),s._v(" "),e("p",[s._v("Open your firewall on your ShadowsocksR port. Consider the possibility of whitelisting the IP addresses that can send traffic to your ShadowsocksR server. In the example given below, we assume you are always connecting from a local ISP that always allocates IP addresses to you in the range 12.34.0.0 through 12.34.255.255. In classless inter-domain routing (CIDR) notation, this is 12.34.0.0/16:")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("sudo iptables -A INPUT -p tcp -s 12.34.0.0/16 --dport 8388 -j ACCEPT\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("If, on the other hand, you want to allow traffic from anywhere to connect to your server, then omit the source specification, i.e.:")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("sudo iptables -A INPUT -p tcp --dport 8388 -j ACCEPT\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("Persist your firewall change across reboots:")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("sudo dpkg-reconfigure iptables-persistent\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("Install the prerequisite packages for ShadowsocksR:")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("sudo apt-get install git python-m2crypto libsodium18\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("We are going to install ShadowsocksR into cd /usr/local, so change into that directory:")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("cd /usr/local\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("Get ShadowsocksR from Github:")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("sudo git clone -b manyuser https://github.com/shadowsocksrr/shadowsocksr.git\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("Create the initial ShadowsocksR configuration file:")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("cd shadowsocksr\n\nsudo bash initcfg.sh\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("p",[s._v("Edit the ShadowsocksR configuration file:")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("sudo vi user-config.json\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("Specify your values for the ShadowsocksR port, password, encryption method, protocol, obfuscation method, and so on. For example:")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('{\n"server": "0.0.0.0",\n"server_ipv6": "::",\n"server_port": 8388,\n"local_address": "127.0.0.1",\n"local_port": 1080,\n"password": "happy2017",\n"method": "aes-128-ctr",\n"protocol": "auth_aes128_md5",\n"protocol_param": "",\n"obfs": "tls1.2_ticket_auth_compatible",\n"obfs_param": "",\n"speed_limit_per_con": 0,\n"speed_limit_per_user": 0,\n"additional_ports" : {},\n"additional_ports_only" : false,\n"timeout": 120,\n"udp_timeout": 60,\n"dns_ipv6": false,\n"connect_verbose_info": 0,\n"redirect": "",\n"fast_open": false\n}\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br")])]),e("p",[s._v("Now create the systemd service file:")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("sudo vi /etc/systemd/system/shadowsocksr.service\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("Insert contents as follows:")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("[Unit]\nDescription=ShadowsocksR server\nAfter=network.target\nWants=network.target\n\n[Service]\nType=forking\nPIDFile=/var/run/shadowsocksr.pid\nExecStart=/usr/bin/python /usr/local/shadowsocksr/shadowsocks/server.py --pid-file /var/run/shadowsocksr.pid -c /usr/local/shadowsocksr/user-config.json -d start\nExecStop=/usr/bin/python /usr/local/shadowsocksr/shadowsocks/server.py --pid-file /var/run/shadowsocksr.pid -c /usr/local/shadowsocksr/user-config.json -d stop\nExecReload=/bin/kill -HUP $MAINPID\nKillMode=process\nRestart=always\n\n[Install]\nWantedBy=multi-user.target\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br")])]),e("p",[s._v("Make ShadowocksR start on reboot, and also start it now:")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("sudo systemctl enable shadowsocksr.service\n\nsudo systemctl start shadowsocksr.service\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("p",[s._v("Check that ShadowsocksR is working as expected:")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("sudo systemctl status shadowsocksr.service\n\nsudo journalctl -u shadowsocksr\n\nsudo netstat -tulpn | grep 8388\n\nsudo tail /var/log/shadowsocksr.log\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("p",[s._v("Assuming your server work is done:")]),s._v(" "),e("p",[s._v("exit")]),s._v(" "),e("h2",{attrs:{id:"advanced-server-configuration"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#advanced-server-configuration"}},[s._v("#")]),s._v(" Advanced Server Configuration")]),s._v(" "),e("p",[s._v("If you are setting up a ShadowsocksR server for shared or public use, there are various optional additions to your basic server configuration.")]),s._v(" "),e("p",[s._v("Optimize System\nEdit the limits.conf file:")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("sudo vi /etc/security/limits.conf\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("Add these two lines to increase the maximum allowable number of open files:")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("* soft nofile 51200\n* hard nofile 51200\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("p",[s._v("Edit the system configuration file:")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("sudo vi /etc/sysctl.conf\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("Prevent automatic insertion of comment lines in the insertions below:")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v(":set formatoptions-=cro\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("Insert the following lines:")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# max open files\nfs.file-max = 51200\n# socket receive buffer 64 MB\nnet.core.rmem_max = 67108864\n# socket send buffer 64 MB\nnet.core.wmem_max = 67108864\n# default read buffer\nnet.core.rmem_default = 65536\n# default write buffer\nnet.core.wmem_default = 65536\n# max processor input queue\nnet.core.netdev_max_backlog = 4096\n# max backlog\nnet.core.somaxconn = 4096\n\n# resist SYN flood attacks\nnet.ipv4.tcp_syncookies = 1\n# reuse timewait sockets when safe\nnet.ipv4.tcp_tw_reuse = 1\n# turn off fast timewait sockets recycling\nnet.ipv4.tcp_tw_recycle = 0\n# short FIN timeout\nnet.ipv4.tcp_fin_timeout = 30\n# short keepalive time\nnet.ipv4.tcp_keepalive_time = 1200\n# outbound port range\nnet.ipv4.ip_local_port_range = 10000 65000\n# max SYN backlog\nnet.ipv4.tcp_max_syn_backlog = 4096\n# max timewait sockets held by system simultaneously\nnet.ipv4.tcp_max_tw_buckets = 5000\n# turn on TCP Fast Open on both client and server side\nnet.ipv4.tcp_fastopen = 3\n# TCP receive buffer\nnet.ipv4.tcp_rmem = 4096 87380 67108864\n# TCP write buffer\nnet.ipv4.tcp_wmem = 4096 65536 67108864\n# turn on path MTU discovery\nnet.ipv4.tcp_mtu_probing = 1\n\n# for high-latency network, uncomment this line:\nnet.ipv4.tcp_congestion_control = hybla\n\n# for low-latency network, uncomment this line:\n# net.ipv4.tcp_congestion_control = cubic\n\n# for BBR, uncomment two lines:\n# net.core.default_qdisc=fq\n# net.ipv4.tcp_congestion_control=bbr\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br"),e("span",{staticClass:"line-number"},[s._v("42")]),e("br"),e("span",{staticClass:"line-number"},[s._v("43")]),e("br"),e("span",{staticClass:"line-number"},[s._v("44")]),e("br"),e("span",{staticClass:"line-number"},[s._v("45")]),e("br"),e("span",{staticClass:"line-number"},[s._v("46")]),e("br"),e("span",{staticClass:"line-number"},[s._v("47")]),e("br"),e("span",{staticClass:"line-number"},[s._v("48")]),e("br"),e("span",{staticClass:"line-number"},[s._v("49")]),e("br")])]),e("p",[s._v("BBR congestion control is available only in Linux kernel 4.9 upwards, e.g. in Debian 9.")]),s._v(" "),e("p",[s._v("Make these changes effective now:")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("sudo sysctl -p\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("Restrict Outbound Ports")]),s._v(" "),e("p",[s._v("To restrict the ports to which your users can send outbound traffic to those commonly used for web browsing, as well as those necessary for ordinary server operation, issue the commands:")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("sudo iptables -A OUTPUT -o lo -j ACCEPT\nsudo iptables -A OUTPUT -p tcp --sport 22 -j ACCEPT\nsudo iptables -A OUTPUT -p udp --dport 53 -j ACCEPT\nsudo iptables -A OUTPUT -p tcp --dport 53 -j ACCEPT\nsudo iptables -A OUTPUT -p udp --dport 67 -j ACCEPT\nsudo iptables -A OUTPUT -p udp --dport 68 -j ACCEPT\nsudo iptables -A OUTPUT -p tcp --dport 80 -j ACCEPT\nsudo iptables -A OUTPUT -p udp --dport 123 -j ACCEPT\nsudo iptables -A OUTPUT -p tcp --dport 443 -j ACCEPT\nsudo iptables -A OUTPUT -p tcp --dport 8080 -j ACCEPT\nsudo iptables -A OUTPUT -p tcp --sport 8388 -j ACCEPT\nsudo iptables -A OUTPUT -p icmp --icmp-type 0 -j ACCEPT\nsudo iptables -P OUTPUT DROP\nsudo dpkg-reconfigure iptables-persistent\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br")])]),e("p",[s._v("In the above example, 8388 is the port chosen for SSR connections. You must change this number if you are using a different port.")]),s._v(" "),e("p",[s._v("Restart ShadowsocksR")]),s._v(" "),e("p",[s._v("Once you have made all your configuration changes, restart your ShadowsocksR server:")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("sudo systemctl stop shadowsocksr.service\n\nsudo systemctl start shadowsocksr.service\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])])])}),[],!1,null,null,null);a.default=t.exports}}]);